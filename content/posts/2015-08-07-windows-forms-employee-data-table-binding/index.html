<hr>
<p>title: Windows Forms Employee Data Table Binding
layout: post
template: post.hbt
permalink: /2015/08/07/windows-forms-employee-data-table-binding/
dzsvg_fullscreen:</p>
<ul>
<li>none
dzsvg_extras_featured:</li>
<li>none
categories:</li>
<li>Spread</li>
<li>Spreadsheets</li>
<li>Tutorials</li>
<li>WinForms</li>
</ul>
<hr>
<p>Data tables are a useful tool for organizing information in an easily-accessible manner. Spread incorporates these tables without the use of confusing code and excessive logic, providing a simple and quick way to fill in spreadsheets and keep them updated. This article walks through a sample Windows Forms application that serves as a database of information about employees and shows the ease with which a user can create bound data tables and multiple forms that are connected using Spread.</p>
<p>To start off, I created five different forms: Employees, EmployeeDetails, AddEmployee, SearchForm, and SearchResult. The Employees form is the main one that starts the application and contains a Spread component, which represents the visualization of the data table. EmployeeDetails is the form that opens when a user wants to view or edit an employee’s information. The AddEmployee form opens when a user adds an employee, and gives the user fields to fill in. The SearchForm allows users to search for an employee by certain categories (ID, First Name, etc.). The SearchResult opens once the user has chosen something to search by, and contains a Spread component with all the details for the employees in the data table that match the criteria.</p>
<p>After creating those forms, I opened up the Employees form and added a Spread component to it. Once I opened that component in the Spread Designer, I changed the number of rows and columns and created the categories as displayed below:<figure id="attachment_664204" style="width: 655px" class="wp-caption aligncenter"></p>
<p><a href="http://sphelp.grapecity.com/wp-content/uploads/2015/08/EmployeesFigure1.png"><img class=" wp-image-664204  " alt="The main Employees Form" src="http://sphelp.grapecity.com/wp-content/uploads/2015/08/EmployeesFigure1-1024x532.png" width="655" height="341" /></a><figcaption class="wp-caption-text">The main Employees Form</figcaption></figure> </p>
<p>The second sheet is used for formatting of an employee’s information in a row, and is copied over whenever an employee is added. For reference, that sheet looks like this:<figure id="attachment_664205" style="width: 717px" class="wp-caption aligncenter"></p>
<p><a href="http://sphelp.grapecity.com/wp-content/uploads/2015/08/EmployeesFigure2.png"><img class=" wp-image-664205 " alt="The second sheet used for formatting." src="http://sphelp.grapecity.com/wp-content/uploads/2015/08/EmployeesFigure2-1024x54.png" width="717" height="38" /></a><figcaption class="wp-caption-text">The second sheet used for formatting.</figcaption></figure> </p>
<p>Most of the cells are formatted as general cells, with the exception of the salary and bonus which are currency cells, and the “Remove Employee” and “View Details…” cells, which are buttons.</p>
<p>The next step is to add the functionality behind the buttons as well as the data table to store the information.� The button functionality is added in the ButtonClicked event:</p>
<pre><code>{
            fpSpread1.SuspendLayout();
            <span class="hljs-keyword">if</span> (fpSpread1.Sheets[<span class="hljs-number">0</span>].ActiveCell.Row.<span class="hljs-variable">Index =</span>= <span class="hljs-number">0</span> &amp;&amp; fpSpread1.Sheets[<span class="hljs-number">0</span>].ActiveCell.Column.<span class="hljs-variable">Index =</span>= <span class="hljs-number">6</span>)
            {
                searchEmployeeDialog();
            }
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (fpSpread1.Sheets[<span class="hljs-number">0</span>].ActiveCell.Row.<span class="hljs-variable">Index =</span>= <span class="hljs-number">1</span> &amp;&amp; fpSpread1.Sheets[<span class="hljs-number">0</span>].ActiveCell.Column.<span class="hljs-variable">Index =</span>= <span class="hljs-number">6</span>)
            {
                <span class="hljs-keyword">if</span> (addEmployeeForm())
                {
                    FarPoint.Win.Spread.Model.CellRange <span class="hljs-variable">cr =</span> new FarPoint.Win.Spread.Model.CellRange(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>);
                    fpSpread1.Sheets[<span class="hljs-number">1</span>].GetClipDataObject(<span class="hljs-constant">false</span>, cr, FarPoint.Win.Spread.ClipboardCopyOptions.Formatting);
                    FarPoint.Win.Spread.Model.CellRange <span class="hljs-variable">cr2 =</span> new FarPoint.Win.Spread.Model.CellRange(fpSpread1.Sheets[<span class="hljs-number">0</span>].RowCount - <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>);
                    fpSpread1.Sheets[<span class="hljs-number">0</span>].ClipboardPaste(FarPoint.Win.Spread.ClipboardPasteOptions.Formatting, fpSpread1.Sheets[<span class="hljs-number">1</span>].GetClipDataObject(<span class="hljs-constant">false</span>, cr,
                                                        FarPoint.Win.Spread.ClipboardCopyOptions.Formatting), cr2);
                }
            }
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (fpSpread1.Sheets[<span class="hljs-number">0</span>].ActiveCell.Column.<span class="hljs-variable">Index =</span>= <span class="hljs-number">7</span>)
            {
                viewEmployeeDetailsDialog(dt.Rows[fpSpread1.Sheets[<span class="hljs-number">0</span>].ActiveCell.Row.Index - <span class="hljs-number">2</span>][<span class="hljs-number">0</span>].ToString());
            }
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (fpSpread1.Sheets[<span class="hljs-number">0</span>].ActiveCell.Column.<span class="hljs-variable">Index =</span>= <span class="hljs-number">6</span>)
            {
                DialogResult <span class="hljs-variable">dr =</span> MessageBox.Show(<span class="hljs-string">"Are you sure you want to remove "</span> + fpSpread1.Sheets[<span class="hljs-number">0</span>].Cells[fpSpread1.Sheets[<span class="hljs-number">0</span>].ActiveCell.Row.Index, <span class="hljs-number">1</span>].Text + <span class="hljs-string">"?"</span>,
                                                    <span class="hljs-string">"Remove Employee"</span>,
                                                    MessageBoxButtons.YesNo, MessageBoxIcon.Question);
                <span class="hljs-keyword">if</span> (<span class="hljs-variable">dr =</span>= DialogResult.Yes)
                {
                    fpSpread1.Sheets[<span class="hljs-number">0</span>].RemoveRows(fpSpread1.ActiveSheet.ActiveRow.Index, <span class="hljs-number">1</span>);
                }
            }
            fpSpread1.ResumeLayout();
        }</code></pre>

<p>Which has a corresponding handler in the Designer.cs file:</p>
<pre><code>When a user clicks <span class="hljs-keyword">on</span> the “<span class="hljs-keyword">Add</span> Employee” button, the addEmployeeForm <span class="hljs-function"><span class="hljs-keyword">method</span> <span class="hljs-title">is</span> <span class="hljs-title">called</span>, <span class="hljs-title">which</span> <span class="hljs-title">creates</span> <span class="hljs-title">a</span> <span class="hljs-title">new</span> <span class="hljs-title">instance</span> <span class="hljs-title">of</span> <span class="hljs-title">the</span> <span class="hljs-title">AddEmployee</span> <span class="hljs-title">form</span> <span class="hljs-title">I</span> <span class="hljs-title">created</span> <span class="hljs-title">earlier</span>:</span></code></pre>public bool addEmployeeForm()
        {
            AddEmployee newEmployee = new AddEmployee();
            newEmployee.ShowDialog();
            if (newEmployee.DialogResult == System.Windows.Forms.DialogResult.Cancel)
                return false;
            return true;
        }<pre><code class="hljs">The result of this <span class="hljs-operator"><span class="hljs-keyword">call</span> determines which button the <span class="hljs-keyword">user</span> chose <span class="hljs-keyword">to</span> click <span class="hljs-keyword">and</span> whether <span class="hljs-keyword">to</span> <span class="hljs-keyword">add</span> the employee <span class="hljs-keyword">to</span> the <span class="hljs-keyword">data</span> <span class="hljs-keyword">table</span>:&lt;figure id=<span class="hljs-string">"attachment_664206"</span> style=<span class="hljs-string">"width: 573px"</span> class=<span class="hljs-string">"wp-caption aligncenter"</span>&gt;

[&lt;img class=<span class="hljs-string">"wp-image-664206 "</span> alt=<span class="hljs-string">"The Add Employee form."</span> src=<span class="hljs-string">"http://sphelp.grapecity.com/wp-content/uploads/2015/08/EmployeesFigure3.png"</span> width=<span class="hljs-string">"573"</span> height=<span class="hljs-string">"354"</span> /&gt;][<span class="hljs-number">3</span>]&lt;figcaption class=<span class="hljs-string">"wp-caption-text"</span>&gt;The <span class="hljs-keyword">Add</span> Employee form.&lt;/figcaption&gt;&lt;/figure&gt; 

<span class="hljs-keyword">From</span> here, the <span class="hljs-keyword">user</span> can <span class="hljs-keyword">add</span> information about the employee <span class="hljs-keyword">in</span> the <span class="hljs-keyword">fields</span> listed, <span class="hljs-keyword">with</span> the ID being the <span class="hljs-keyword">key</span> <span class="hljs-keyword">for</span> the <span class="hljs-keyword">data</span> <span class="hljs-keyword">table</span>.� <span class="hljs-keyword">As</span> such, this <span class="hljs-keyword">is</span> the one <span class="hljs-keyword">field</span> that must be <span class="hljs-keyword">unique</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">for</span> the <span class="hljs-keyword">table</span> <span class="hljs-keyword">to</span> be searched correctly.� The <span class="hljs-keyword">only</span> functions that <span class="hljs-keyword">are</span> required <span class="hljs-keyword">to</span> make this <span class="hljs-keyword">work</span> <span class="hljs-keyword">are</span> the button_clicked <span class="hljs-keyword">event</span> handlers: one <span class="hljs-keyword">for</span> “Accept” <span class="hljs-keyword">and</span> the other <span class="hljs-keyword">for</span> “Cancel”.

Once the <span class="hljs-keyword">variables</span> <span class="hljs-keyword">are</span> <span class="hljs-keyword">set</span> via the <span class="hljs-built_in">text</span> boxes, the AddToDataTable <span class="hljs-keyword">function</span> <span class="hljs-keyword">is</span> called <span class="hljs-keyword">with</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">of</span> the <span class="hljs-keyword">fields</span> passed <span class="hljs-keyword">into</span> it.� This <span class="hljs-keyword">function</span> adds the employee <span class="hljs-keyword">to</span> the <span class="hljs-keyword">data</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">with</span> their information:</span></code></pre>public static void addToDataTable(string id, string firstName, string lastName, int salary, int bonus, string department, string hireDate, string phoneNumber, string email)
        {
            DataRow row = dt.NewRow();
            row["id"] = id;
            row["firstName"] = firstName;
            row["lastName"] = lastName;
            row["salary"] = salary;
            row["bonus"] = bonus;
            row["department"] = department;
            row["hireDate"] = hireDate;
            row["phoneNumber"] = phoneNumber;
            row["email"] = email;
            dt.Rows.Add(row);
        }<pre><code class="hljs">A similar <span class="hljs-tag">form</span> is the EmployeeDetails <span class="hljs-tag">form</span>, which allows <span class="hljs-tag">a</span> user to edit an employee’s information, except <span class="hljs-keyword">for</span> the ID because it is the key <span class="hljs-keyword">for</span> the <span class="hljs-tag">table</span>:&lt;<span class="hljs-tag">figure</span> id=<span class="hljs-string">"attachment_664207"</span> style=<span class="hljs-string">"width: 581px"</span> class=<span class="hljs-string">"wp-caption aligncenter"</span>&gt;

[&lt;<span class="hljs-tag">img</span> class=<span class="hljs-string">" wp-image-664207 "</span> alt=<span class="hljs-string">"The Employee Details Form."</span> src=<span class="hljs-string">"http://sphelp.grapecity.com/wp-content/uploads/2015/08/EmployeesFigure4.png"</span> <span class="hljs-attribute">width</span>=<span class="hljs-string">"581"</span> <span class="hljs-attribute">height</span>=<span class="hljs-string">"353"</span> /&gt;][<span class="hljs-number">4</span>]&lt;<span class="hljs-tag">figcaption</span> class=<span class="hljs-string">"wp-caption-text"</span>&gt;The Employee Details Form.&lt;/figcaption&gt;&lt;/figure&gt; 

Similar to the AddEmployee <span class="hljs-tag">form</span>, the only <span class="hljs-tag">code</span> required here is <span class="hljs-keyword">for</span> the buttons, which edits the specified employee’s information using the EditDataTable function:</code></pre>public static void editDataTable(string id, string firstName, string lastName, int salary, int bonus, string department, string hireDate, string phoneNumber, string email)
        {
            DataRow row = dt.Rows.Find(id);
            row["id"] = id;
            row["firstName"] = firstName;
            row["lastName"] = lastName;
            row["salary"] = salary;
            row["bonus"] = bonus;
            row["department"] = department;
            row["hireDate"] = hireDate;
            row["phoneNumber"] = phoneNumber;
            row["email"] = email;
        }<pre><code class="hljs">Once those forms are complete, <span class="hljs-keyword">the</span> base functionality <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> spreadsheet <span class="hljs-keyword">is</span> complete.� The only problem <span class="hljs-keyword">is</span> <span class="hljs-keyword">that</span> usually there are a lot <span class="hljs-keyword">of</span> employees <span class="hljs-keyword">that</span> need <span class="hljs-keyword">to</span> have their information retained, <span class="hljs-keyword">and</span> <span class="hljs-keyword">it</span> could take a <span class="hljs-keyword">while</span> <span class="hljs-keyword">to</span> find a specific employee.� In order <span class="hljs-keyword">to</span> make <span class="hljs-keyword">it</span> easier, I added search functionality using two forms: SearchForm <span class="hljs-keyword">and</span> SearchResult.&lt;figure <span class="hljs-property">id</span>=<span class="hljs-string">"attachment_664208"</span> style=<span class="hljs-string">"width: 465px"</span> <span class="hljs-type">class</span>=<span class="hljs-string">"wp-caption aligncenter"</span>&gt;

[&lt;img <span class="hljs-type">class</span>=<span class="hljs-string">" wp-image-664208 "</span> alt=<span class="hljs-string">"The Search Form used to search for employees."</span> src=<span class="hljs-string">"http://sphelp.grapecity.com/wp-content/uploads/2015/08/EmployeesFigure5.png"</span> width=<span class="hljs-string">"465"</span> height=<span class="hljs-string">"223"</span> /&gt;][<span class="hljs-number">5</span>]&lt;figcaption <span class="hljs-type">class</span>=<span class="hljs-string">"wp-caption-text"</span>&gt;The Search Form used <span class="hljs-keyword">to</span> search <span class="hljs-keyword">for</span> employees.&lt;/figcaption&gt;&lt;/figure&gt; 

The SearchForm <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> simplest one <span class="hljs-keyword">in</span> this project, <span class="hljs-keyword">with</span> two fields <span class="hljs-keyword">and</span> one button.� The “Category” field <span class="hljs-function_start"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword">the</span> left <span class="hljs-keyword">is</span> a drop-down <span class="hljs-type">list</span> <span class="hljs-keyword">that</span> <span class="hljs-keyword">contains</span> all <span class="hljs-keyword">the</span> categories <span class="hljs-keyword">of</span> information <span class="hljs-keyword">to</span> search <span class="hljs-keyword">by</span>.� The <span class="hljs-type">text</span> box <span class="hljs-function_start"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword">the</span> right <span class="hljs-keyword">is</span> actually a part <span class="hljs-keyword">of</span> a custom <span class="hljs-type">text</span> box <span class="hljs-keyword">to</span> display a hint <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> <span class="hljs-type">text</span> box <span class="hljs-function_start"><span class="hljs-keyword">on</span></span> what <span class="hljs-keyword">to</span> type, which I have called a CueTextBox.

As <span class="hljs-keyword">with</span> <span class="hljs-keyword">the</span> other forms, <span class="hljs-keyword">the</span> code <span class="hljs-keyword">for</span> this form <span class="hljs-keyword">is</span> really simple.� It only requires code <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> button_clicked event handler, <span class="hljs-keyword">and</span> <span class="hljs-keyword">is</span> used <span class="hljs-keyword">to</span> open up <span class="hljs-keyword">the</span> SearchResult form <span class="hljs-keyword">with</span> <span class="hljs-keyword">the</span> specified parameters (<span class="hljs-keyword">the</span> category <span class="hljs-keyword">to</span> search <span class="hljs-keyword">in</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">the</span> <span class="hljs-type">text</span> <span class="hljs-keyword">to</span> search <span class="hljs-keyword">for</span>):</code></pre>private void button1_Click(object sender, EventArgs e)
        {
            SearchResult result = new SearchResult(toCamelCase(this.comboBox1.Text), this.cueTextBox1.Text);
            result.ShowDialog();
        }<pre><code class="hljs">The “toCamelCase” function <span class="hljs-keyword">is</span> used <span class="hljs-keyword">to</span> convert <span class="hljs-keyword">the</span> user-facing names <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> categories <span class="hljs-keyword">into</span> <span class="hljs-keyword">the</span> column names referred <span class="hljs-keyword">to</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> data table.� Once <span class="hljs-keyword">the</span> SearchResult form <span class="hljs-keyword">is</span> created, <span class="hljs-keyword">it</span> <span class="hljs-keyword">is</span> populated <span class="hljs-keyword">with</span> <span class="hljs-keyword">the</span> <span class="hljs-constant">result</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> search, which can include multiple results:&lt;figure <span class="hljs-property">id</span>=<span class="hljs-string">"attachment_664209"</span> style=<span class="hljs-string">"width: 717px"</span> <span class="hljs-type">class</span>=<span class="hljs-string">"wp-caption aligncenter"</span>&gt;

[&lt;img <span class="hljs-type">class</span>=<span class="hljs-string">" wp-image-664209 "</span> alt=<span class="hljs-string">"The Search Result form to display the results of the search."</span> src=<span class="hljs-string">"http://sphelp.grapecity.com/wp-content/uploads/2015/08/EmployeesFigure6-1024x256.png"</span> width=<span class="hljs-string">"717"</span> height=<span class="hljs-string">"179"</span> /&gt;][<span class="hljs-number">6</span>]&lt;figcaption <span class="hljs-type">class</span>=<span class="hljs-string">"wp-caption-text"</span>&gt;The Search Result form <span class="hljs-keyword">to</span> display <span class="hljs-keyword">the</span> results <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> search.&lt;/figcaption&gt;&lt;/figure&gt; 

Similar <span class="hljs-keyword">to</span> <span class="hljs-keyword">the</span> main form, this has another sheet titled “Employee”, which has a row formatted <span class="hljs-keyword">to</span> <span class="hljs-keyword">the</span> specific columns <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> sheet.� � Just like <span class="hljs-keyword">the</span> main form, <span class="hljs-keyword">the</span> formatting <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> row <span class="hljs-keyword">is</span> copied <span class="hljs-keyword">over</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">the</span> main sheet <span class="hljs-keyword">every</span> <span class="hljs-property">time</span> an employee <span class="hljs-keyword">is</span> added.� This sheet <span class="hljs-keyword">is</span> also connected <span class="hljs-keyword">to</span> <span class="hljs-keyword">the</span> main data table <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> <span class="hljs-type">application</span>, so editing an employee’s information <span class="hljs-keyword">or</span> removing them <span class="hljs-keyword">is</span> reflected <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> data table <span class="hljs-keyword">and</span> <span class="hljs-keyword">the</span> main form.

The SearchResult form <span class="hljs-keyword">is</span> initialized <span class="hljs-keyword">with</span> both a column <span class="hljs-keyword">to</span> search <span class="hljs-keyword">in</span> <span class="hljs-keyword">and</span> a <span class="hljs-type">string</span> <span class="hljs-keyword">to</span> search <span class="hljs-keyword">for</span>.� Those parameters are taken <span class="hljs-keyword">and</span> a row filter <span class="hljs-keyword">is</span> created <span class="hljs-keyword">out of</span> <span class="hljs-keyword">that</span>:</code></pre>DataView dv = new DataView(Employees.getDataTable());
            dv.RowFilter = column + " = '" + search +"'";

            FarPoint.Win.Spread.Data.SpreadDataBindingAdapter data = new FarPoint.Win.Spread.Data.SpreadDataBindingAdapter();
            data.DataSource = dv;
            data.Spread = fpSpread2;
            data.SheetName = "Employees Table";
            data.MapperInfo = new FarPoint.Win.Spread.Data.MapperInfo(1, 0, dv.Count, 6);
            data.FillSpreadDataByDataSource();<pre><code class="hljs">Any row <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> data table <span class="hljs-keyword">that</span> has <span class="hljs-keyword">the</span> specified <span class="hljs-type">string</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> specified column will be added <span class="hljs-keyword">to</span> <span class="hljs-keyword">the</span> data view, which <span class="hljs-keyword">is</span> seen <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> SearchResult form.

After putting together all <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> different components, <span class="hljs-keyword">it</span> would be useful <span class="hljs-keyword">to</span> save <span class="hljs-keyword">the</span> information <span class="hljs-keyword">about</span> <span class="hljs-keyword">the</span> employees <span class="hljs-keyword">for</span> use later.� To do this, simply add a “File” toolbar menu <span class="hljs-property">item</span> <span class="hljs-keyword">at</span> <span class="hljs-keyword">the</span> top <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> main form <span class="hljs-keyword">with</span> buttons <span class="hljs-keyword">for</span> “Open” <span class="hljs-keyword">and</span> “Save”:&lt;figure <span class="hljs-property">id</span>=<span class="hljs-string">"attachment_664211"</span> style=<span class="hljs-string">"width: 266px"</span> <span class="hljs-type">class</span>=<span class="hljs-string">"wp-caption aligncenter"</span>&gt;

[&lt;img <span class="hljs-type">class</span>=<span class="hljs-string">" wp-image-664211 "</span> alt=<span class="hljs-string">"The File Menu with options for Opening and Saving files."</span> src=<span class="hljs-string">"http://sphelp.grapecity.com/wp-content/uploads/2015/08/EmployeesFigure7.png"</span> width=<span class="hljs-string">"266"</span> height=<span class="hljs-string">"222"</span> /&gt;][<span class="hljs-number">7</span>]&lt;figcaption <span class="hljs-type">class</span>=<span class="hljs-string">"wp-caption-text"</span>&gt;The File Menu <span class="hljs-keyword">with</span> options <span class="hljs-keyword">for</span> Opening <span class="hljs-keyword">and</span> Saving files.&lt;/figcaption&gt;&lt;/figure&gt; 

In order <span class="hljs-keyword">to</span> save both <span class="hljs-keyword">the</span> sheet <span class="hljs-keyword">and</span> <span class="hljs-keyword">the</span> underlying data table, I have decided <span class="hljs-keyword">to</span> save them <span class="hljs-keyword">as</span> two separate XML files.� Both files have <span class="hljs-keyword">the</span> same <span class="hljs-property">name</span> except “DataTable” <span class="hljs-keyword">is</span> added <span class="hljs-keyword">onto</span> <span class="hljs-keyword">the</span> <span class="hljs-keyword">end</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> XML <span class="hljs-type">file</span> <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> data table (In <span class="hljs-keyword">the</span> windows explorer <span class="hljs-keyword">it</span> <span class="hljs-keyword">is</span> an “.XMLDataTable” <span class="hljs-type">file</span>).

To do this, I added an event <span class="hljs-keyword">for</span> clicking <span class="hljs-keyword">the</span> save button:</code></pre>private void saveToolStripMenuItem_Click(object sender, EventArgs e)
        {
            string filename = "";
            SaveFileDialog sfd = new SaveFileDialog();
            sfd.Filter = "XML Files (*.xml)|*.xml|All files (*.*)|*.*";
            DialogResult dr = sfd.ShowDialog();
            if (dr == DialogResult.OK)
            {
                filename = sfd.FileName;
            }
            if (filename != "")
            {
                fpSpread1.Save(filename, FarPoint.Win.Spread.SaveXMLOptions.All);
                dt.WriteXml(filename + "DataTable");
            }
        }<pre><code class="hljs">This <span class="hljs-keyword">function</span> uses the Data Table’s WriteXml <span class="hljs-keyword">function</span>, which writes the data table <span class="hljs-keyword">to</span> an xml <span class="hljs-keyword">file</span> <span class="hljs-keyword">with</span> the specified name.� <span class="hljs-keyword">To</span> match this functionality, I also added the event <span class="hljs-keyword">for</span> clicking the <span class="hljs-keyword">open</span> button:</code></pre>

<p>When opening an Employee data table, the previous information is cleared out, so as to prevent duplicate keys from being made.� The data binding adapter is used to bind the new data table to the sheet, and updates the sheet to reflect the changes.</p>
<p>In this blog, I have gone over the steps for creating an Employee spreadsheet that is bound to a data table.� The data table was created column-by-column and bound to the spreadsheet with just a few lines of code.� New forms were added and initialized by other forms with simple and intuitive code.� Using Visual Studio to create the forms also made it easier to add fields and labels and position them in the exact place that I wanted.� This blog has shown how, with little effort, an employee spreadsheet and bound data table can be created with only a small amount of code and the power of Spread.</p>
<p>&nbsp;</p>
<p>Attached is the project that shows these concepts in action.</p>
<p><a href="http://sphelp.grapecity.com/wp-content/uploads/2015/08/Employees.zip">Employees</a></p>
