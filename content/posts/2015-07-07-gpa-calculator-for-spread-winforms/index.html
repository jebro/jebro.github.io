<hr>
<p>title: GPA Calculator for Spread Winforms
layout: post
template: post.hbt
permalink: /2015/07/07/gpa-calculator-for-spread-winforms/
dzsvg_fullscreen:</p>
<ul>
<li>none
dzsvg_extras_featured:</li>
<li>none
categories:</li>
<li>Spread</li>
<li>Spreadsheets</li>
<li>Tutorials</li>
<li>WinForms</li>
</ul>
<hr>
<p>One of the main advantages of Spread is its ability to help you design and create calculation-based applications quickly and easily with little code. To demonstrate these capabilities, let’s use something that we are all familiar with: GPA calculation. This article walks through a sample application that calculates a student grade point average and shows how easy it is to create a nice looking template, add formulas, and add UI with very little code using Spread.</p>
<p>To begin, I created a template using the Spread Designer. The designer allows me to set colors, fonts, and other visual properties, as well as add formulas in an interface very similar to that of Excel. Once I have created the template, I can save it in an XML file which the Spread control in my application will load. You can see in the following screen shot that I have designed an application with a color theme, buttons, various cell types, and calculation fields. One of the key features here to note is that there are two cells at the top for the Add and Remove Semester buttons and column titles and one row at the bottom for the cumulative GPA:</p>
<p style="text-align: center;">
  <a href="http://sphelp.grapecity.com/wp-content/uploads/2015/07/GPAFigure1.png"><img class="wp-image-663801 aligncenter" alt="GPAFigure1" src="http://sphelp.grapecity.com/wp-content/uploads/2015/07/GPAFigure1-1024x778.png" width="738" height="560" /></a>
</p>

<p>The types of the cells are as follows: General in first column, number in columns B, D, and E, and combo box for C, except for the semester GPA and cumulative GPA cells.<br>Spread templates are easy to use and include in the project: when you save a template, an XML file is created and then added to the project as an embedded resource at runtime. Spread handles this for you, so you don’t have to do anything.<br>These templates can contain many more features than those I have added to this sample (this particular� sample is kept simple to show Spread’s core features). For example, I can group rows so that only� semester GPAs and totals show up, as in the second semester block in the picture below.</p>
<p style="text-align: center;">
  <a href="http://sphelp.grapecity.com/wp-content/uploads/2015/07/GPAFigure2.png"><img class=" wp-image-663802 aligncenter" alt="GPAFigure2" src="http://sphelp.grapecity.com/wp-content/uploads/2015/07/GPAFigure2-1024x757.png" width="655" height="485" /></a>
</p>

<p>This is how my application works. As you have already seen, the main tab shows GPA by semester. Notice the two buttons, Add Semester and Remove Semester, at the top. When clicked, these add or remove a template block of cells for a semester to and from the sheet. This is done by storing that semester template in a separate, locked sheet. When the Add Semester button is clicked, that block is copied to the main sheet. The screen shot bellows shows an example of that semester block as a template set of cells, which gets copied to the main sheet.</p>
<p style="text-align: center;">
  <a href="http://sphelp.grapecity.com/wp-content/uploads/2015/07/GPAFigure3.png"><img class="wp-image-663803 aligncenter" alt="GPAFigure3" src="http://sphelp.grapecity.com/wp-content/uploads/2015/07/GPAFigure3.png" width="277" height="362" /></a>
</p>

<p>To add or remove these cells, I only need to add a few lines of code to the ButtonClicked event, which is called whenever the “Add Semester” or “Remove Semester” buttons are clicked. In the code below, cell ranges are created to contain the copied data and to provide a location to copy the data to (after rows are added). When cells are copied, formatting, formulas, and cell types are retained.</p>
<pre><code>{
            fpSpread1.SuspendLayout();
            <span class="hljs-keyword">if</span> (fpSpread1.Sheets[<span class="hljs-number">0</span>].ActiveCell.Row.<span class="hljs-variable">Index =</span>= <span class="hljs-number">0</span> &amp;&amp; fpSpread1.Sheets[<span class="hljs-number">0</span>].ActiveCell.Column.<span class="hljs-variable">Index =</span>= <span class="hljs-number">3</span>)
            {
                fpSpread1.Sheets[<span class="hljs-number">0</span>].AddRows(fpSpread1.Sheets[<span class="hljs-number">0</span>].Rows.Count-<span class="hljs-number">1</span>, <span class="hljs-number">19</span>);
                FarPoint.Win.Spread.Model.CellRange <span class="hljs-variable">cr =</span> new FarPoint.Win.Spread.Model.CellRange(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">19</span>, <span class="hljs-number">5</span>);
                fpSpread1.Sheets[<span class="hljs-number">2</span>].GetClipDataObject(<span class="hljs-constant">false</span>, cr, FarPoint.Win.Spread.ClipboardCopyOptions.All);
                FarPoint.Win.Spread.Model.CellRange <span class="hljs-variable">cr2 =</span> new FarPoint.Win.Spread.Model.CellRange(fpSpread1.Sheets[<span class="hljs-number">0</span>].RowCount-<span class="hljs-number">20</span>, <span class="hljs-number">0</span>, <span class="hljs-number">19</span>, <span class="hljs-number">5</span>);
                fpSpread1.Sheets[<span class="hljs-number">0</span>].ClipboardPaste(FarPoint.Win.Spread.ClipboardPasteOptions.All, fpSpread1.Sheets[<span class="hljs-number">2</span>].GetClipDataObject(<span class="hljs-constant">false</span>, cr, 
                                                    FarPoint.Win.Spread.ClipboardCopyOptions.All), cr2);
                fpSpread1.Sheets[<span class="hljs-number">0</span>].AddRangeGroup(fpSpread1.Sheets[<span class="hljs-number">0</span>].RowCount - <span class="hljs-number">19</span>, <span class="hljs-number">16</span>, <span class="hljs-constant">true</span>);
                fpSpread1.Sheets[<span class="hljs-number">0</span>].Rows[fpSpread1.Sheets[<span class="hljs-number">0</span>].RowCount - <span class="hljs-number">2</span>].<span class="hljs-variable">Height =</span> <span class="hljs-number">30</span>;
                semesterCount++;
                fpSpread1.Sheets[<span class="hljs-number">0</span>].Cells[fpSpread1.Sheets[<span class="hljs-number">0</span>].RowCount - <span class="hljs-number">20</span>, <span class="hljs-number">0</span>].<span class="hljs-variable">Text =</span> <span class="hljs-string">"Semester "</span> + semesterCount;
            }
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (fpSpread1.Sheets[<span class="hljs-number">0</span>].ActiveCell.Row.<span class="hljs-variable">Index =</span>= <span class="hljs-number">0</span> &amp;&amp; fpSpread1.Sheets[<span class="hljs-number">0</span>].ActiveCell.Column.<span class="hljs-variable">Index =</span>= <span class="hljs-number">4</span>)
            {
                fpSpread1.Sheets[<span class="hljs-number">0</span>].RemoveRows(fpSpread1.Sheets[<span class="hljs-number">0</span>].Rows.Count - <span class="hljs-number">20</span>, <span class="hljs-number">19</span>);
                semesterCount--;
            }
            fpSpread1.ResumeLayout();
        }</code></pre>

<p>On the main sheet, the user can choose the letter grade from a drop down, and the application automatically assigns a point value (the “Grade” and “Scale” columns, or Columns C and D). There is also a separate sheet and table for the letter grade and quality point relationship used in this assignment.</p>
<p style="text-align: center;">
  <a href="http://sphelp.grapecity.com/wp-content/uploads/2015/07/GPAFigure4.png"><img class=" wp-image-663804 aligncenter" alt="GPAFigure4" src="http://sphelp.grapecity.com/wp-content/uploads/2015/07/GPAFigure4.png" width="391" height="414" /></a>
</p>

<p>This is utilized in conjunction with the VLOOKUP formula:</p>
<pre><code>The above table is called GradeLookup. This formula looks <span class="hljs-operator">in</span> that table <span class="hljs-keyword">for</span> <span class="hljs-operator">the</span> specified letter grade that <span class="hljs-operator">the</span> user selects <span class="hljs-built_in">from</span> <span class="hljs-operator">a</span> drop down cell <span class="hljs-operator">in</span> column C <span class="hljs-operator">and</span> places <span class="hljs-operator">the</span> <span class="hljs-built_in">result</span> <span class="hljs-operator">in</span> column D.  
For <span class="hljs-operator">the</span> calculations <span class="hljs-operator">in</span> column E, <span class="hljs-operator">the</span> grade points are multiplied <span class="hljs-keyword">by</span> <span class="hljs-operator">the</span> <span class="hljs-built_in">number</span> <span class="hljs-operator">of</span> credits <span class="hljs-keyword">for</span> <span class="hljs-keyword">each</span> course through this formula:</code></pre>IF(ISBLANK(RC[-3]),"",RC[-3]*RC[-1])<pre><code class="hljs">All <span class="hljs-operator">of</span> this is useful, but <span class="hljs-keyword">it</span> would be better <span class="hljs-keyword">if</span> you could save <span class="hljs-operator">and</span> <span class="hljs-built_in">open</span> semesters that you have already filled out, so <span class="hljs-built_in">add</span> toolbar menu <span class="hljs-keyword">items</span> <span class="hljs-built_in">to</span> <span class="hljs-operator">the</span> Form like so:

&lt;p style=<span class="hljs-string">"text-align: center;"</span>&gt;
  &lt;<span class="hljs-operator">a</span> href=<span class="hljs-string">"http://sphelp.grapecity.com/wp-content/uploads/2015/07/GPAFigure5.png"</span>&gt;&lt;img class=<span class="hljs-string">"wp-image-663805 aligncenter"</span> alt=<span class="hljs-string">"GPAFigure5"</span> src=<span class="hljs-string">"http://sphelp.grapecity.com/wp-content/uploads/2015/07/GPAFigure5.png"</span> width=<span class="hljs-string">"336"</span> height=<span class="hljs-string">"240"</span> /&gt;&lt;/<span class="hljs-operator">a</span>&gt;
&lt;/p&gt;

To <span class="hljs-built_in">add</span> these buttons, simply <span class="hljs-built_in">open</span> up <span class="hljs-operator">the</span> toolbox <span class="hljs-operator">in</span> Visual Studio <span class="hljs-operator">and</span> <span class="hljs-built_in">add</span> <span class="hljs-operator">the</span> “MenuStrip” component <span class="hljs-built_in">to</span> <span class="hljs-operator">the</span> top <span class="hljs-operator">of</span> <span class="hljs-operator">the</span> form <span class="hljs-keyword">by</span> clicking <span class="hljs-keyword">it</span> <span class="hljs-operator">and</span> dragging <span class="hljs-keyword">it</span> <span class="hljs-keyword">into</span> <span class="hljs-operator">the</span> form. Once you have done that, you can give <span class="hljs-operator">the</span> buttons names <span class="hljs-keyword">by</span> clicking <span class="hljs-operator">in</span> <span class="hljs-operator">the</span> “Type Here” box <span class="hljs-operator">and</span> typing <span class="hljs-operator">a</span> name <span class="hljs-keyword">for</span> <span class="hljs-operator">the</span> button. In this example, I used “File” <span class="hljs-keyword">as</span> <span class="hljs-operator">the</span> menu header <span class="hljs-operator">and</span> added <span class="hljs-constant">two</span> menu <span class="hljs-keyword">items</span> under <span class="hljs-keyword">it</span> (“Open” <span class="hljs-operator">and</span> “Save”).  
Once <span class="hljs-operator">the</span> buttons are laid out, I have <span class="hljs-built_in">to</span> <span class="hljs-built_in">add</span> <span class="hljs-operator">the</span> code <span class="hljs-built_in">to</span> make these buttons work. In <span class="hljs-operator">the</span> &lt;projectname&gt;.Designer.cs <span class="hljs-built_in">file</span>, <span class="hljs-operator">a</span> <span class="hljs-built_in">line</span> should be created <span class="hljs-keyword">for</span> <span class="hljs-keyword">each</span> button like so:</code></pre>private System.Windows.Forms.ToolStripMenuItem &lt;buttonname&gt;ToolStripMenuItem<pre><code class="hljs">In the case of this example, the Open <span class="hljs-tag">button</span> is referred to as:

&lt;pre&gt;&lt;<span class="hljs-tag">code</span> class=<span class="hljs-string">"&amp;quot;language-csharp”"</span>&gt;private System<span class="hljs-class">.Windows</span><span class="hljs-class">.Forms</span><span class="hljs-class">.ToolStripMenuItem</span> openToolStripMenuItem</code></pre>

<p>A function should be added for each button using this name and adding “_Click” on the end of it. In this example, the Open button’s function definition is the following:</p>
<pre><code>&amp;nbsp;

In <span class="hljs-keyword">this</span> example the save <span class="hljs-keyword">and</span> open buttons are the only buttons <span class="hljs-literal">that</span> need code <span class="hljs-keyword">to</span> make them <span class="hljs-attribute">work</span>:</code></pre>

<p>Now GPA sheets that have been created with this sample can be stored and opened at a later time.<br>This sample has demonstrated how, with little effort, you can create an interactive calculator application. Thousands of Spread users apply these concepts for financial calculators, scientific data collection, sales reporting, and much more.</p>
<p>Here is a link to download the Visual Studio solution for this project:</p>
<p><a href="http://sphelp.grapecity.com/wp-content/uploads/2015/07/GPA-Calculator.zip">GPA Calculator</a></p>
