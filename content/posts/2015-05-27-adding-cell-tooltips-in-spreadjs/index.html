<hr>
<p>title: Adding Cell ToolTips in SpreadJS
layout: post
template: post.hbt
permalink: /2015/05/27/adding-cell-tooltips-in-spreadjs/
dzsvg_fullscreen:</p>
<ul>
<li>none
dzsvg_extras_featured:</li>
<li>none
categories:</li>
<li>HTML5</li>
<li>jQuery</li>
<li>Spread</li>
<li>SpreadJS</li>
<li>Spreadsheets</li>
<li>Tutorials</li>
</ul>
<hr>
<p>Adding Tooltips to Spreadsheets is a common usage where you want to show additional information about cells.<strong>� SpreadJS</strong> allows you to display the <strong>tooltip</strong> only for the <strong>HyperlinkCellType. </strong>However, you may want to show cell tooltips for any type of cell, say for instance to display the current cell location in a tooltip.</p>
<p>SpreadJS provides simple solution for this. Here in this blog lets discuss two different yet simple approaches that will help you to create and display tooltips for all the cells in SpreadJS.</p>
<h3 id="-font-color-blue-using-a-customcelltype-font-"><font color="blue">Using a CustomCellType</font></h3>
<p>The first approach is to use a <strong>CustomCelltype</strong>. For the demonstration purpose, lets name this customcelltype as� <strong>TipCellType</strong> which will display tooltips for the cells.</p>
<pre>[csharp]$(function ()
{
  function TipCellType()
  {
  }
  TipCellType.prototype = new $.wijmo.wijspread.TextCellType();
  TipCellType.prototype.getHitInfo = function (x, y, row, col, cellStyle, cellRect, sheetArea) {
     return { x: x, y: y, row: row, col: col, cellStyle: cellStyle, cellRect: cellRect, sheetArea: sheetArea };
  }
  TipCellType.prototype.processMouseEnter = function (hitinfo){
    if (!this._toolTipElement) {
        var div = document.createElement("div");
        $(div).css("position", "absolute")
          .css("border", "1px #C0C0C0 solid")
          .css("box-shadow", "1px 2px 5px rgba(0,0,0,0.4)")
          .css("font", "9pt Arial")
          .css("background", "white")
          .css("padding", 5);
          this._toolTipElement = div;
        }
     $(this._toolTipElement).text("Cell [R:" + hitinfo.row + "] : [C:" + hitinfo.col + "]")
        .css("top", hitinfo.y + 15)
        .css("left", hitinfo.x + 15);
         $(this._toolTipElement).hide();
        document.body.insertBefore(this._toolTipElement, null);
        $(this._toolTipElement).show("fast");
 };
 TipCellType.prototype.processMouseLeave = function (hitinfo) {
    if (this._toolTipElement) {
        document.body.removeChild(this._toolTipElement);
        this._toolTipElement = null;
     }
 };

 $("#ss").wijspread();
 var spread = $("#ss").wijspread("spread");
 var sheet = spread.getActiveSheet();
 spread.useWijmoTheme = true;
 spread.repaint();
 sheet.getDefaultStyle().cellType = new TipCellType();

 var dataValidator = new $.wijmo.wijspread.DefaultDataValidator();
 dataValidator.type = $.wijmo.wijspread.CriteriaType.AnyValue;
 dataValidator.showInputMessage = true;
 dataValidator.inputTitle = "test";
 dataValidator.inputMessage = "Here is a tip."
 sheet.getCell(2, 2).value("click here").dataValidator(dataValidator);
});[/csharp]</pre>

<h3 id="-font-color-blue-monitor-the-dom-mouse-events-font-"><font color="blue"> Monitor the DOM Mouse events</font></h3>
<p>The second approach is useful where you would want to show dynamic tooltips on mouse hover. This can be done simply by using <strong>DOM� **</strong>Mouse� events**� to display tooltips. Here is the code:</p>
<pre>[csharp]$(function ()
{
  $("#ss").wijspread();
  var spread = $("#ss").wijspread("spread");
  var sheet = spread.getActiveSheet();
  $("#ss").mouseenter(function () {
     if (!_toolTipElement) {
         _toolTipElement = createTipElement();
         document.body.insertBefore(_toolTipElement, null);
         $(_toolTipElement).hide();
      }
  });
 $("#ss").mouseleave(function () {
      console.log("leave");
      document.body.removeChild(_toolTipElement);
       _toolTipElement = null;
});

$("#ss").mousemove(function (event) {
   var leftOffset = event.pageX;
   var topOffset = event.pageY;
   var hitInfo = sheet.hitTest(leftOffset - $("#ss").offset().left, topOffset - $("#ss").offset().top);
   if (hitInfo) {
      if (hitInfo.hitTestType === $.wijmo.wijspread.SheetArea.viewport
           && !hitInfo.dragInfo
           && hitInfo.row != undefined
           && hitInfo.col != undefined) {
                var newCell = sheet.getCell(hitInfo.row, hitInfo.col);
                if (!oldCell) {
                  oldCell = newCell;
                }
                if (oldCell.row != newCell.row || oldCell.col != newCell.col) {
                   $(_toolTipElement).hide();
                   oldCell = newCell;
                   var cellRect = sheet.getCellRect(oldCell.row, oldCell.col);
                   $(_toolTipElement).text("Cell [R:" + oldCell.row + "] : [C:" + oldCell.col + "]")
                         .css("top", hitInfo.y + 15)
                         .css("left", hitInfo.x + 15).show("fast");
                  }
           return;
       }
    }
    oldCell = null;
    $(_toolTipElement).hide();
 });
});[/csharp]</pre>

<p><em>Please Note: This approach does not work for IE10</em></p>
<h3 id="-font-color-blue-conclusion-font-"><font color="blue">Conclusion</font></h3>
<p>With both the approaches, you can generate a Spreadsheet as the image shows here<br><a href="http://wijmo.com/wp-content/uploads/2013/12/Output.png"><img class="alignnone size-full wp-image-18122" title="Output" alt="" src="http://wijmo.com/wp-content/uploads/2013/12/Output.png" width="518" height="301" /></a></p>
<p>Download the source code of the <a title="http://sphelp.grapecity.com/wp-content/uploads/2013/12/Sample.zip" href="http://sphelp.grapecity.com/wp-content/uploads/2013/12/Sample.zip" target="_blank">sample</a> for complete implementation.</p>
