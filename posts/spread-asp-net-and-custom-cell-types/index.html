<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Spread ASP.NET and Custom Cell Types</title>
    <meta name="description" content="Spread Studio is our new cross-platform toolkit that includes components for Windows Forms, ASP.NET, WPF, WinRT, and Silverlight all in one package. This new package includes the new releases of Spread for WinForms and Spread for ASP.NET." name="description" />
    <meta name="keywords" content="Spread.NET, ASP.NET, WPF, Silverlight, WinRT, .NET, spreadsheets, Data, PDF, Spreadsheet, Grid, Excel, analysis, GrapeCity, ASP.NET Spreadsheet component, .NET Spreadsheet component">

    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/favicon-194x194.png" sizes="194x194">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <meta name="DC.title" content="GrapeCity Spread" />
    <meta name="geo.region" content="US-NC" />
    <meta name="geo.placename" content="Raleigh" />
    <meta name="geo.position" content="40.458677;-79.924935" />
    <meta name="ICBM" content="40.458677, -79.924935" />

    <!-- Schema.org markup for Google+ -->
    <meta itemprop="name" content="GrapeCity Spread">
    <meta itemprop="description" content="Spreadsheet Components for .NET and JavaScript-HTML5">
    <meta itemprop="image" content="http://spread.grapecity.com/img/spread-photo.png">
    <link href="https://plus.google.com/103999002053720301182/" rel="publisher" />

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="GrapeCity Spread">
    <meta name="twitter:site" content="@gcspread">
    <meta name="twitter:title" content="Spreadsheet Components for .NET and JavaScript-HTML5">
    <meta name="twitter:description" content="Spreadsheet Components for .NET and JavaScript-HTML5">
    <meta name="twitter:creator" content="@gcspread">
    <meta name="twitter:image" content="http://spread.grapecity.com/img/spread-photo.png">

    <!-- Open Graph data -->
    <meta property="og:title" content="GrapeCity Spread" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="http://spread.grapecity.com/" />
    <meta property="og:image" content="http://spread.grapecity.com/img/spread-photo.png" />
    <meta property="og:description" content="Spreadsheet Components for .NET and JavaScript-HTML5" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/css/style.css?v=1" />

</head>

<body class=" page-Spread ASP.NET and Custom Cell Types">
    <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->




    <main class="body-section">
        <article class="body-inner">    <div class="nav-bar">
        <div class="nav-bar-inner">
            <div class="wrapper">
                <div class="padder clearfix">
                    <div class="search-container clearfix">
                        <input placeholder="Search" type="search" />
                        <a class="search-trigger" href="#"><span class="lnr lnr-magnifier"></span></a>
                    </div>
                    <div class="user-container">
                        <a class="user-trigger" href="#"><span class="lnr lnr-user"></span> <span class="menu-text">Account</span></a>
                        <ul class="user-list hidden">
                            <li><a href="#"><span class="lnr lnr-exit-up"></span> Sign Out</a></li>
                            <li><a href="#"><span class="lnr lnr-license"></span> Licenses</a></li>
                            <li><a href="#"><span class="lnr lnr-bug"></span> Submit An Issue</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>


<aside class="brand-section">
        <div class="brand-inner clearfix">
            <div class="brand-main">
                <div class="brand-logo">
                    <div class="padder clearfix">
                        <h2><a href="/"><img src="/img/sp-icon-white.svg" alt="Spread" /><span class="logo-text">Spread</span> </a></h2>
                    </div>
                </div>
            </div>
            <nav class="nav-main">
                <div class="nav-section">
                    <div class="padder clearfix">
                        <ul class="clearfix">
                            <li class="studio">
                                <a href="/products/spread-studio/"><img src="/img/sp-icon.svg" /><span class="menu-text">Spread Studio</span></a>
                            </li>
                            <li class="js">
                                <a href="/products/spreadjs/"><img src="/img/js-icon.svg" /><span class="menu-text">SpreadJS</span></a>
                            </li>
                            <li class="com">
                                <a href="/products/spread-com/"><img src="/img/com-icon.svg" /><span class="menu-text">Spread COM</span></a>
                            </li>
                            <li><a href="/pages/downloads/"><span class="lnr lnr-download"></span><span class="menu-text">Downloads</span></a></li>
                            <li><a href="/pages/demo-gallery/"><span class="lnr lnr-cog"></span><span class="menu-text">Demo Gallery</span></a></li>
                            <li><a href="/pages/pricing/"><span class="lnr lnr-cart"></span><span class="menu-text">Pricing</span></a></li>
                            <li><a href="/pages/support-community/"><span class="lnr lnr-bubble"></span><span class="menu-text">Support & Community</span></a></li>
                            <li><a href="/pages/documentation/"><span class="lnr lnr-book"></span><span class="menu-text">Documentation</span></a></li>
                        </ul>
                    </div>
                </div>
            </nav>
            <div class="brand-container">
                <div class="padder clearfix">
                    <div class="brand-more">
                        <a class="brand-more-trigger" href="javascript:void(0);"><span class="lnr lnr-menu"></span> <span class="menu-text">More Tools</span></a>
                        <ul class="brand-more-list hidden">
                            <li><a href="#"><span class="lnr lnr-diamond"></span> ActiveReports</a></li>
                            <li><a href="#"><span class="lnr lnr-poop"></span> ComponentOne</a></li>
                            <li><a href="#"><span class="lnr lnr-bug"></span> Wijmo</a></li>
                            <li><a href="#"><span class="lnr lnr-thumbs-down"></span> Xuni</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </aside><header>
    <div class="wrapper">
        <div class="padder clearfix">
            <h1><span class="lnr lnr-book"></span> Spread ASP.NET and Custom Cell Types</h1>
            <h3></h3>
        </div>
</header>


<div class="wrapper-sections">
    <section class="section-page">
        <div class="wrapper">
            <div class="padder clearfix">
                <div class="entry">

                    <p>Spread ASP.NET allows you to create your own custom cell types. This can be useful if a default cell type does not have the feature you need.</p>
<p>You can implement your own types of cells by creating a subclass that inherits an existing cell type (that is, override methods in that class). The custom cell type class should be marked as serializable so it works for the view state.</p>
<p>The BaseCellType class is a class from which the built-in text based cell types (for example, general, text, number, data-time, and so on.) are derived. The class can also be used to derive custom cell types that are text based. The data model can hold any value, including colors. The cell type is always passed the raw value from the data model.</p>
<p>You can override any of the following methods to create a custom cell.</p>
<p>BaseCellType methods:</p>
<table border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td valign="top" width="399">
      Clone
    </td>

    <td valign="top" width="399">
      Creates a new copy of the object using the MemberwiseClone method.
    </td>
  </tr>

  <tr>
    <td valign="top" width="399">
      Format
    </td>

    <td valign="top" width="399">
      When deriving a cell type based on this type, override this to change what gets passed back and formatted as a string into the cell on the sheet from the object in the data model.
    </td>
  </tr>

  <tr>
    <td valign="top" width="399">
      GetEditorControl
    </td>

    <td valign="top" width="399">
      Gets the control used to edit the cell.
    </td>
  </tr>

  <tr>
    <td valign="top" width="399">
      GetEditorValue
    </td>

    <td valign="top" width="399">
      Gets the value from the editing control used for the cell.
    </td>
  </tr>

  <tr>
    <td valign="top" width="399">
      GetPreferredSize
    </td>

    <td valign="top" width="399">
      Gets the preferred (maximum required) size of the cell for the renderer control when printing to PDF.
    </td>
  </tr>

  <tr>
    <td valign="top" width="399">
      GetValidators
    </td>

    <td valign="top" width="399">
      Gets the validator collection, overwrite this method to allow customizing the returned result from the Validators property.
    </td>
  </tr>

  <tr>
    <td valign="top" width="399">
      PaintCell
    </td>

    <td valign="top" width="399">
      Gets a control and renders it in the cell based on the specified appearance, margin, and value.
    </td>
  </tr>

  <tr>
    <td valign="top" width="399">
      Parse
    </td>

    <td valign="top" width="399">
      When deriving a cell type based on this type, override this to change what gets parsed from the cell on the sheet and put in the data model.
    </td>
  </tr>

  <tr>
    <td valign="top" width="399">
      RendererClientScriptUrl2
    </td>

    <td valign="top" width="399">
      Gets the URL of the client script file for the renderer for the specified Spread component, if the renderer supports client-side scripting.
    </td>
  </tr>

  <tr>
    <td valign="top" width="399">
      SetTabIndex
    </td>

    <td valign="top" width="399">
      Sets TabIndex for the editor.
    </td>
  </tr>

  <tr>
    <td valign="top" width="399">
      ToString
    </td>

    <td valign="top" width="399">
      Gets the name of the cell type.
    </td>
  </tr>

  <tr>
    <td valign="top" width="399">
      ValidateEditorValue
    </td>

    <td valign="top" width="399">
      Validates the given value.
    </td>
  </tr>
</table>

<p>The Format method is used to get the string value to put in the clipboard text for the cell. The Parse method is used to convert that clipboard text back into a value when pasting. The methods are also generally used for converting the raw value to a string and back when editing, but that depends on the implementation of the cell type (most built-in cell types operate that way but a custom cell type does not need to). For example, the custom cell type might allow the user to edit the value as a URL string, and render it with an image tag, if the custom cell type displays an image. In that case, Format or Parse might not actually be needed since it would just copy or paste the raw URL value and also use that in the data model.</p>
<p>You can override any of the following properties in the BaseCellType class:</p>
<table border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td valign="top" width="399">
      EditorClientScriptUrl
    </td>

    <td valign="top" width="399">
      Gets the URL of the client script file for the editor, if the editor supports client-side scripting.
    </td>
  </tr>

  <tr>
    <td valign="top" width="399">
      RendererClientScriptUrl
    </td>

    <td valign="top" width="399">
      Gets the URL of the client script file for the renderer, if the renderer supports client-side scripting.
    </td>
  </tr>

  <tr>
    <td valign="top" width="399">
      Validators
    </td>

    <td valign="top" width="399">
      Gets the validator collection.
    </td>
  </tr>
</table>

<p>The RenderClientScriptUrl2 method and the RenderClientScriptUrl and EditorClientScriptUrl properties do not take effect with Internet Explorer 10 or higher or with other browsers such as Firefox or Chrome. They are provided for the older style HTC model.</p>
<p>This example creates a custom cell from a combo cell and overrides the GetEditorControl method to disable a specific item in the drop-down list.</p>
<p>C#</p>
<pre><code class="language-csharp">using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using FarPoint.Web.Spread;

namespace SpreadASPNET8CSharp
{
    public partial class WebForm1 : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            customCombo ComboCell = new customCombo();
            ComboCell.Items = new String[] { "Jan", "Feb", "March", "April" };
            ComboCell.BackColor = System.Drawing.Color.Aqua;
            FpSpread1.Sheets[0].Cells[0, 0].CellType = ComboCell;
        }
    }

    [Serializable()]
    public class customCombo : FarPoint.Web.Spread.ComboBoxCellType
    {
        public override Control GetEditorControl(string id, TableCell parent, Appearance style, Inset margin, object value, bool upperLevel)
        {
            DropDownList ddl = (System.Web.UI.WebControls.DropDownList)base.GetEditorControl(id, parent, style, margin, value, upperLevel);

            if (ddl != null)
            {
                foreach (System.Web.UI.WebControls.ListItem item in ddl.Items)
                {
                    if (item.Value == "Feb")
                    {
                        item.Attributes.Add("disabled", "disabled");
                    }
                }
            }
            return ddl;
        }

    }
}
</code></pre>

<p>VB</p>
<pre><code class="language-csharp">Imports FarPoint.Web.Spread

Public Class WebForm1
    Inherits System.Web.UI.Page
    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Dim ComboCell As New customCombo
        ComboCell.Items = New String() {"Jan", "Feb", "March", "April"}
        ComboCell.BackColor = Drawing.Color.Aqua
        FpSpread1.Sheets(0).Cells(0, 0).CellType = ComboCell
    End Sub
End Class

&lt;Serializable()&gt; Public Class customCombo
    Inherits FarPoint.Web.Spread.ComboBoxCellType

    Public Overrides Function GetEditorControl(id As String, parent As TableCell, style As Appearance, margin As Inset, value As Object, upperLevel As Boolean) As Control
        Dim ddl As DropDownList = CType(MyBase.GetEditorControl(id, parent, style, margin, value, upperLevel), System.Web.UI.WebControls.DropDownList)
        If IsNothing(ddl) Then Exit Function
        For Each item As System.Web.UI.WebControls.ListItem In ddl.Items
            If item.Value = "Feb" Then
                item.Attributes.Add("disabled", "disabled")
            End If
        Next
        Return ddl
    End Function   
End Class
</code></pre>

<p>You can download a larger example that demonstrates custom cells and renderers from this link: <a href="http://sphelp.grapecity.com/wp-content/uploads/2015/11/EditorRendererCS.zip">EditorRendererCS.</a> The zip file does not contain the Spread ASP.NET assemblies.</p>


                </div>
            </div>
        </div>
    </section>
</div>
           <footer>
                <div class="wrapper clearfix">
                    <div class="footer-column footer-half">
                        <div class="padder clearfix">
                            <h3>About Spread Studio</h3>
                            <p>Spread Studio is a multi-functional component that combines the utility of a grid with the power and flexibility of a spreadsheet to help developers working in Microsoft® Visual Studio and JavaScript add Microsoft® Excel functionality to their applications or websites. One package delivers a powerful formula engine, input controls, an API, full data import/export for Excel files, advanced charts, print support, and PDF export. Spread Studio is the only component you need in your toolbox for data bound and unbound WinForms, WPF, WinRT, ASP.NET, and JavaScript applications.</p>
                            <p class="copyright-paragraph">
                                ©
                                <span><script>document.write(new Date().getFullYear())</script></span> <img src="/img/company/grapecity_150.png" alt="GrapeCity">, inc. All Rights Reserved. All product and company names herein may be trademarks of their respective owners.
                            </p>

                        </div>
                    </div>
                    <div class="footer-column footer-column-menu">
                        <div class="padder clearfix">
                            <h3>Company</h3>
                            <ul class="footer-menu clearfix">
                                <li><a href="/about-us/">About Us</a></li>
                                <li><a href="/contact-us/">Contact Us</a></li>
                                <li><a href="/legal/">Legal Information</a></li>
                                <li><a href="/privacy/">Privacy Policy</a></li>
                                <li><a href="/terms/">Terms of Use</a></li>
                            </ul>

                        </div>

                    </div>


                </div>
            </footer>
        </article>
    </main>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="/js/dist/jquery.unslider-dist.js"></script>
    <script src="/js/dist/jquery.matchHeight-dist.js"></script>
    <script src="/js/dist/jquery.waypoints-dist.js"></script>
    <script src="/js/dist/jquery.nicescroll-dist.js"></script>
    <script src="/js/dist/jquery.velocity-dist.js"></script>
    <script src="/js/dist/jquery.event.move-dist.js"></script>
    <script src="/js/dist/jquery.event.swipe-dist.js"></script>
    <script src="/js/dist/init-dist.js"></script>



</body>

</html> 