<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Spread WPF and Array Formulas</title>
    <meta name="description" content="Spread Studio is our new cross-platform toolkit that includes components for Windows Forms, ASP.NET, WPF, WinRT, and Silverlight all in one package. This new package includes the new releases of Spread for WinForms and Spread for ASP.NET." name="description" />
    <meta name="keywords" content="Spread.NET, ASP.NET, WPF, Silverlight, WinRT, .NET, spreadsheets, Data, PDF, Spreadsheet, Grid, Excel, analysis, GrapeCity, ASP.NET Spreadsheet component, .NET Spreadsheet component">

    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/favicon-194x194.png" sizes="194x194">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <meta name="DC.title" content="GrapeCity Spread" />
    <meta name="geo.region" content="US-NC" />
    <meta name="geo.placename" content="Raleigh" />
    <meta name="geo.position" content="40.458677;-79.924935" />
    <meta name="ICBM" content="40.458677, -79.924935" />

    <!-- Schema.org markup for Google+ -->
    <meta itemprop="name" content="GrapeCity Spread">
    <meta itemprop="description" content="Spreadsheet Components for .NET and JavaScript-HTML5">
    <meta itemprop="image" content="http://spread.grapecity.com/img/spread-photo.png">
    <link href="https://plus.google.com/103999002053720301182/" rel="publisher" />

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="GrapeCity Spread">
    <meta name="twitter:site" content="@gcspread">
    <meta name="twitter:title" content="Spreadsheet Components for .NET and JavaScript-HTML5">
    <meta name="twitter:description" content="Spreadsheet Components for .NET and JavaScript-HTML5">
    <meta name="twitter:creator" content="@gcspread">
    <meta name="twitter:image" content="http://spread.grapecity.com/img/spread-photo.png">

    <!-- Open Graph data -->
    <meta property="og:title" content="GrapeCity Spread" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="http://spread.grapecity.com/" />
    <meta property="og:image" content="http://spread.grapecity.com/img/spread-photo.png" />
    <meta property="og:description" content="Spreadsheet Components for .NET and JavaScript-HTML5" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/css/style.css?v=1" />

</head>

<body class=" page-Spread WPF and Array Formulas">
    <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->




    <main class="body-section">
        <article class="body-inner">    <div class="nav-bar">
        <div class="nav-bar-inner">
            <div class="wrapper">
                <div class="padder clearfix">
                    <div class="search-container clearfix">
                        <input placeholder="Search" type="search" />
                        <a class="search-trigger" href="#"><span class="lnr lnr-magnifier"></span></a>
                    </div>
                    <div class="user-container">
                        <a class="user-trigger" href="#"><span class="lnr lnr-user"></span> <span class="menu-text">Account</span></a>
                        <ul class="user-list hidden">
                            <li><a href="#"><span class="lnr lnr-exit-up"></span> Sign Out</a></li>
                            <li><a href="#"><span class="lnr lnr-license"></span> Licenses</a></li>
                            <li><a href="#"><span class="lnr lnr-bug"></span> Submit An Issue</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>


<aside class="brand-section">
        <div class="brand-inner clearfix">
            <div class="brand-main">
                <div class="brand-logo">
                    <div class="padder clearfix">
                        <h2><a href="/"><img src="/img/sp-icon-white.svg" alt="Spread" /><span class="logo-text">Spread</span> </a></h2>
                    </div>
                </div>
            </div>
            <nav class="nav-main">
                <div class="nav-section">
                    <div class="padder clearfix">
                        <ul class="clearfix">
                            <li class="studio">
                                <a href="/products/spread-studio/"><img src="/img/sp-icon.svg" /><span class="menu-text">Spread Studio</span></a>
                            </li>
                            <li class="js">
                                <a href="/products/spreadjs/"><img src="/img/js-icon.svg" /><span class="menu-text">SpreadJS</span></a>
                            </li>
                            <li class="com">
                                <a href="/products/spread-com/"><img src="/img/com-icon.svg" /><span class="menu-text">Spread COM</span></a>
                            </li>
                            <li><a href="/pages/downloads/"><span class="lnr lnr-download"></span><span class="menu-text">Downloads</span></a></li>
                            <li><a href="/pages/demo-gallery/"><span class="lnr lnr-cog"></span><span class="menu-text">Demo Gallery</span></a></li>
                            <li><a href="/pages/pricing/"><span class="lnr lnr-cart"></span><span class="menu-text">Pricing</span></a></li>
                            <li><a href="/pages/support-community/"><span class="lnr lnr-bubble"></span><span class="menu-text">Support & Community</span></a></li>
                            <li><a href="/pages/documentation/"><span class="lnr lnr-book"></span><span class="menu-text">Documentation</span></a></li>
                        </ul>
                    </div>
                </div>
            </nav>
            <div class="brand-container">
                <div class="padder clearfix">
                    <div class="brand-more">
                        <a class="brand-more-trigger" href="javascript:void(0);"><span class="lnr lnr-menu"></span> <span class="menu-text">More Tools</span></a>
                        <ul class="brand-more-list hidden">
                            <li><a href="#"><span class="lnr lnr-diamond"></span> ActiveReports</a></li>
                            <li><a href="#"><span class="lnr lnr-poop"></span> ComponentOne</a></li>
                            <li><a href="#"><span class="lnr lnr-bug"></span> Wijmo</a></li>
                            <li><a href="#"><span class="lnr lnr-thumbs-down"></span> Xuni</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </aside><header>
    <div class="wrapper">
        <div class="padder clearfix">
            <h1><span class="lnr lnr-book"></span> Spread WPF and Array Formulas</h1>
            <h3></h3>
        </div>
</header>


<div class="wrapper-sections">
    <section class="section-page">
        <div class="wrapper">
            <div class="padder clearfix">
                <div class="entry">

                    <p>Array formulas allow you to do complex tasks with formulas. They allow you to calculate the values of multiple cells at once and they are useful for summarizing a spreadsheet database. You can replace multiple standard formulas with a single array formula.</p>
<p>For general information about array formulas, refer to this web site: <a title="https://support.office.com/en-au/article/Guidelines-and-examples-of-array-formulas-3be0c791-3f89-4644-a062-8e6e9ecee523" href="https://support.office.com/en-au/article/Guidelines-and-examples-of-array-formulas-3be0c791-3f89-4644-a062-8e6e9ecee523" target="_blank">https://support.office.com/en-au/article/Guidelines-and-examples-of-array-formulas-3be0c791-3f89-4644-a062-8e6e9ecee523</a>.</p>
<p>Spread WPF supports array formulas. An array formula can perform multiple calculations on one or more items in an array. Array formulas can return multiple results or a single result.</p>
<p>To create an array formula, select the cells you wish to put the formula in, type the formula, and then use Ctrl + Shift + Enter. This puts braces around the formula and places an instance of the formula in each cell of the selected range. In code, use the SetArrayFormula method instead of the SetFormula method.</p>
<p>In order to remove or change an array formula, you must select the original formula range first.</p>
<p>This example uses the SetArrayFormula method to create an array formula.<figure id="attachment_663863" style="width: 348px" class="wp-caption aligncenter"></p>
<p><a href="http://sphelp.grapecity.com/wp-content/uploads/2015/07/sumarrary.png"><img class="size-full wp-image-663863 " alt="sumarrary" src="http://sphelp.grapecity.com/wp-content/uploads/2015/07/sumarrary.png" width="348" height="143" /></a><figcaption class="wp-caption-text">Result of Sample Code</figcaption></figure> </p>
<p>C#</p>
<pre><code class="language-csharp">gcSpreadSheet1.Sheets[0].Cells[0, 1].Text = "Value A";
gcSpreadSheet1.Sheets[0].Cells[0, 2].Text = "Value B";
gcSpreadSheet1.Sheets[0].Cells[0, 3].Text = "Result";
gcSpreadSheet1.Sheets[0].Cells[0, 1].HorizontalAlignment = GrapeCity.Windows.SpreadSheet.Data.CellHorizontalAlignment.Center;
gcSpreadSheet1.Sheets[0].Cells[0, 2].HorizontalAlignment = GrapeCity.Windows.SpreadSheet.Data.CellHorizontalAlignment.Center;
gcSpreadSheet1.Sheets[0].Cells[0, 3].HorizontalAlignment = GrapeCity.Windows.SpreadSheet.Data.CellHorizontalAlignment.Center;
gcSpreadSheet1.Sheets[0].Cells[1, 1].Value = 4;
gcSpreadSheet1.Sheets[0].Cells[1, 2].Value = 3;
gcSpreadSheet1.Sheets[0].Cells[2, 1].Value = 2;
gcSpreadSheet1.Sheets[0].Cells[2, 2].Value = 2;
gcSpreadSheet1.Sheets[0].Cells[3, 1].Value = 5;
gcSpreadSheet1.Sheets[0].Cells[3, 2].Value = 7;
gcSpreadSheet1.Sheets[0].Cells[4, 1].Value = 6;
gcSpreadSheet1.Sheets[0].Cells[4, 2].Value = 2;
gcSpreadSheet1.Sheets[0].SetArrayFormula(1, 3, 4, 1, "B2:B5*C2:C5");</code></pre>

<p>VB</p>
<pre><code class="language-csharp">
GcSpreadSheet1.Sheets(0).Cells(0, 1).Text = "Value A"
GcSpreadSheet1.Sheets(0).Cells(0, 2).Text = "Value B"
GcSpreadSheet1.Sheets(0).Cells(0, 3).Text = "Result"
GcSpreadSheet1.Sheets(0).Cells(0, 1).HorizontalAlignment = GrapeCity.Windows.SpreadSheet.Data.CellHorizontalAlignment.Center
GcSpreadSheet1.Sheets(0).Cells(0, 2).HorizontalAlignment = GrapeCity.Windows.SpreadSheet.Data.CellHorizontalAlignment.Center
GcSpreadSheet1.Sheets(0).Cells(0, 3).HorizontalAlignment = GrapeCity.Windows.SpreadSheet.Data.CellHorizontalAlignment.Center
GcSpreadSheet1.Sheets(0).Cells(1, 1).Value = 4
GcSpreadSheet1.Sheets(0).Cells(1, 2).Value = 3
GcSpreadSheet1.Sheets(0).Cells(2, 1).Value = 2
GcSpreadSheet1.Sheets(0).Cells(2, 2).Value = 2
GcSpreadSheet1.Sheets(0).Cells(3, 1).Value = 5
GcSpreadSheet1.Sheets(0).Cells(3, 2).Value = 7
GcSpreadSheet1.Sheets(0).Cells(4, 1).Value = 6
GcSpreadSheet1.Sheets(0).Cells(4, 2).Value = 2
GcSpreadSheet1.Sheets(0).SetArrayFormula(1, 3, 4, 1, "B2:B5*C2:C5")
</code></pre>

<p>This example sums two columns if the values in Column B are less than five.<figure id="attachment_663866" style="width: 291px" class="wp-caption aligncenter"></p>
<p><a href="http://sphelp.grapecity.com/wp-content/uploads/2015/07/arrayform2.png"><img class="size-full wp-image-663866 " alt="arrayform2" src="http://sphelp.grapecity.com/wp-content/uploads/2015/07/arrayform2.png" width="291" height="184" /></a><figcaption class="wp-caption-text">Result of Sample Code</figcaption></figure> </p>
<p>C#</p>
<pre><code class="language-csharp">gcSpreadSheet1.Sheets[0].Cells[0, 1].Text = "Value A";
gcSpreadSheet1.Sheets[0].Cells[0, 2].Text = "Value B";
gcSpreadSheet1.Sheets[0].Cells[6, 0].Text = "Sum (B*C if B &lt; 5)";
gcSpreadSheet1.CanCellOverflow = true;
gcSpreadSheet1.Sheets[0].Cells[0, 1].HorizontalAlignment = GrapeCity.Windows.SpreadSheet.Data.CellHorizontalAlignment.Center;
gcSpreadSheet1.Sheets[0].Cells[0, 2].HorizontalAlignment = GrapeCity.Windows.SpreadSheet.Data.CellHorizontalAlignment.Center;
gcSpreadSheet1.Sheets[0].Cells[0, 3].HorizontalAlignment = GrapeCity.Windows.SpreadSheet.Data.CellHorizontalAlignment.Center;
gcSpreadSheet1.Sheets[0].Cells[1, 1].Value = 4;
gcSpreadSheet1.Sheets[0].Cells[1, 2].Value = 3;
gcSpreadSheet1.Sheets[0].Cells[2, 1].Value = 2;
gcSpreadSheet1.Sheets[0].Cells[2, 2].Value = 2;
gcSpreadSheet1.Sheets[0].Cells[3, 1].Value = 5;
gcSpreadSheet1.Sheets[0].Cells[3, 2].Value = 7;
gcSpreadSheet1.Sheets[0].Cells[4, 1].Value = 6;
gcSpreadSheet1.Sheets[0].Cells[4, 2].Value = 2;
gcSpreadSheet1.Sheets[0].SetArrayFormula(6, 2, 1, 1, "Sum(IF(B2:B5&lt;5,B2:B5*C2:C5))");
</code></pre>

<p>VB</p>
<pre><code class="language-csharp">GcSpreadSheet1.Sheets(0).Cells(0, 1).Text = "Value A"
GcSpreadSheet1.Sheets(0).Cells(0, 2).Text = "Value B"
GcSpreadSheet1.Sheets(0).Cells(6, 0).Text = "Sum (B*C if B &lt; 5)"
GcSpreadSheet1.CanCellOverflow = True
GcSpreadSheet1.Sheets(0).Cells(0, 1).HorizontalAlignment = GrapeCity.Windows.SpreadSheet.Data.CellHorizontalAlignment.Center
GcSpreadSheet1.Sheets(0).Cells(0, 2).HorizontalAlignment = GrapeCity.Windows.SpreadSheet.Data.CellHorizontalAlignment.Center
GcSpreadSheet1.Sheets(0).Cells(0, 3).HorizontalAlignment = GrapeCity.Windows.SpreadSheet.Data.CellHorizontalAlignment.Center
GcSpreadSheet1.Sheets(0).Cells(1, 1).Value = 4
GcSpreadSheet1.Sheets(0).Cells(1, 2).Value = 3
GcSpreadSheet1.Sheets(0).Cells(2, 1).Value = 2
GcSpreadSheet1.Sheets(0).Cells(2, 2).Value = 2
GcSpreadSheet1.Sheets(0).Cells(3, 1).Value = 5
GcSpreadSheet1.Sheets(0).Cells(3, 2).Value = 7
GcSpreadSheet1.Sheets(0).Cells(4, 1).Value = 6
GcSpreadSheet1.Sheets(0).Cells(4, 2).Value = 2
GcSpreadSheet1.Sheets(0).SetArrayFormula(6, 2, 1, 1, "Sum(IF(B2:B5&lt;5,B2:B5*C2:C5))")
</code></pre>

<p>Users can enter a formula in a cell by starting with an equals sign (=). Type the equal sign and then the formula such as = sum(A1+B1). Use Ctrl + Shift + Enter to create an array formula after entering the formula.</p>
<p>The following image was created by typing =B2:B5*C3:C5 in a cell and then using Ctrl + Shift + Enter to change the formula to an array formula.<figure id="attachment_663868" style="width: 414px" class="wp-caption aligncenter"></p>
<p><a href="http://sphelp.grapecity.com/wp-content/uploads/2015/07/TypeFormula1.png"><img class="size-full wp-image-663868 " alt="TypeFormula1" src="http://sphelp.grapecity.com/wp-content/uploads/2015/07/TypeFormula1.png" width="414" height="124" /></a><figcaption class="wp-caption-text">Array Formula</figcaption></figure> </p>
<p>You can double-click on the formula cell to see the array formula and selection area.<figure id="attachment_663867" style="width: 485px" class="wp-caption aligncenter"></p>
<p><a href="http://sphelp.grapecity.com/wp-content/uploads/2015/07/TypeFormula.png"><img class="size-full wp-image-663867 " alt="TypeFormula" src="http://sphelp.grapecity.com/wp-content/uploads/2015/07/TypeFormula.png" width="485" height="289" /></a><figcaption class="wp-caption-text">Selection Area</figcaption></figure> </p>
<p>You can prevent or allow the user to enter formulas with the CanUserEditFormula property.<br>C#</p>
<pre><code class="language-csharp">gcSpreadSheet1.CanUserEditFormula = true;</code></pre>

<p>VB</p>
<pre><code class="language-csharp">GcSpreadSheet1.CanUserEditFormula = True</code></pre>



                </div>
            </div>
        </div>
    </section>
</div>
           <footer>
                <div class="wrapper clearfix">
                    <div class="footer-column footer-half">
                        <div class="padder clearfix">
                            <h3>About Spread Studio</h3>
                            <p>Spread Studio is a multi-functional component that combines the utility of a grid with the power and flexibility of a spreadsheet to help developers working in Microsoft® Visual Studio and JavaScript add Microsoft® Excel functionality to their applications or websites. One package delivers a powerful formula engine, input controls, an API, full data import/export for Excel files, advanced charts, print support, and PDF export. Spread Studio is the only component you need in your toolbox for data bound and unbound WinForms, WPF, WinRT, ASP.NET, and JavaScript applications.</p>
                            <p class="copyright-paragraph">
                                ©
                                <span><script>document.write(new Date().getFullYear())</script></span> <img src="/img/company/grapecity_150.png" alt="GrapeCity">, inc. All Rights Reserved. All product and company names herein may be trademarks of their respective owners.
                            </p>

                        </div>
                    </div>
                    <div class="footer-column footer-column-menu">
                        <div class="padder clearfix">
                            <h3>Company</h3>
                            <ul class="footer-menu clearfix">
                                <li><a href="/about-us/">About Us</a></li>
                                <li><a href="/contact-us/">Contact Us</a></li>
                                <li><a href="/legal/">Legal Information</a></li>
                                <li><a href="/privacy/">Privacy Policy</a></li>
                                <li><a href="/terms/">Terms of Use</a></li>
                            </ul>

                        </div>

                    </div>


                </div>
            </footer>
        </article>
    </main>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="/js/dist/jquery.unslider-dist.js"></script>
    <script src="/js/dist/jquery.matchHeight-dist.js"></script>
    <script src="/js/dist/jquery.waypoints-dist.js"></script>
    <script src="/js/dist/jquery.nicescroll-dist.js"></script>
    <script src="/js/dist/jquery.velocity-dist.js"></script>
    <script src="/js/dist/jquery.event.move-dist.js"></script>
    <script src="/js/dist/jquery.event.swipe-dist.js"></script>
    <script src="/js/dist/init-dist.js"></script>



</body>

</html> 