<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Spread Windows Forms and Drag and Drop</title>
    <meta name="description" content="Spread Studio is our new cross-platform toolkit that includes components for Windows Forms, ASP.NET, WPF, WinRT, and Silverlight all in one package. This new package includes the new releases of Spread for WinForms and Spread for ASP.NET." name="description" />
    <meta name="keywords" content="Spread.NET, ASP.NET, WPF, Silverlight, WinRT, .NET, spreadsheets, Data, PDF, Spreadsheet, Grid, Excel, analysis, GrapeCity, ASP.NET Spreadsheet component, .NET Spreadsheet component">

    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/favicon-194x194.png" sizes="194x194">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <meta name="DC.title" content="GrapeCity Spread" />
    <meta name="geo.region" content="US-NC" />
    <meta name="geo.placename" content="Raleigh" />
    <meta name="geo.position" content="40.458677;-79.924935" />
    <meta name="ICBM" content="40.458677, -79.924935" />

    <!-- Schema.org markup for Google+ -->
    <meta itemprop="name" content="GrapeCity Spread">
    <meta itemprop="description" content="Spreadsheet Components for .NET and JavaScript-HTML5">
    <meta itemprop="image" content="http://spread.grapecity.com/img/spread-photo.png">
    <link href="https://plus.google.com/103999002053720301182/" rel="publisher" />

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="GrapeCity Spread">
    <meta name="twitter:site" content="@gcspread">
    <meta name="twitter:title" content="Spreadsheet Components for .NET and JavaScript-HTML5">
    <meta name="twitter:description" content="Spreadsheet Components for .NET and JavaScript-HTML5">
    <meta name="twitter:creator" content="@gcspread">
    <meta name="twitter:image" content="http://spread.grapecity.com/img/spread-photo.png">

    <!-- Open Graph data -->
    <meta property="og:title" content="GrapeCity Spread" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="http://spread.grapecity.com/" />
    <meta property="og:image" content="http://spread.grapecity.com/img/spread-photo.png" />
    <meta property="og:description" content="Spreadsheet Components for .NET and JavaScript-HTML5" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/css/style.css?v=1" />

</head>

<body class=" page-Spread Windows Forms and Drag and Drop">
    <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->




    <main class="body-section">
        <article class="body-inner">    <div class="nav-bar">
        <div class="nav-bar-inner">
            <div class="wrapper">
                <div class="padder clearfix">
                    <div class="search-container clearfix">
                        <input placeholder="Search" type="search" />
                        <a class="search-trigger" href="#"><span class="lnr lnr-magnifier"></span></a>
                    </div>
                    <div class="user-container clearfix">
                        <a class="user-trigger" href="#"><span class="lnr lnr-user"></span> <span class="menu-text">Account</span></a>
                        <ul class="user-list hidden">
                            <li><a href="#"><span class="lnr lnr-exit-up"></span> Sign Out</a></li>
                            <li><a href="#"><span class="lnr lnr-license"></span> Licenses</a></li>
                            <li><a href="#"><span class="lnr lnr-bug"></span> Submit An Issue</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>


<aside class="brand-section">
        <div class="brand-inner clearfix">
            <div class="brand-main">
                <div class="brand-logo">
                    <div class="padder clearfix">
                        <h2><a href="/"><img src="/img/sp-icon-white.svg" alt="Spread" /><span class="logo-text">Spread</span> </a></h2>
                    </div>
                </div>
            </div>
            <nav class="nav-main">
                <div class="nav-section">
                    <div class="padder clearfix">
                        <ul class="clearfix">
                            <li class="studio">
                                <a href="/products/spread-studio/"><img src="/img/sp-icon.svg" /><span class="menu-text">Spread Studio</span></a>
                            </li>
                            <li class="js">
                                <a href="/products/spreadjs/"><img src="/img/js-icon.svg" /><span class="menu-text">SpreadJS</span></a>
                            </li>
                            <li class="com">
                                <a href="/products/spread-com/"><img src="/img/com-icon.svg" /><span class="menu-text">Spread COM</span></a>
                            </li>
                            <li><a href="/pages/downloads/"><span class="lnr lnr-download"></span><span class="menu-text">Downloads</span></a></li>
                            <li><a href="/pages/demo-gallery/"><span class="lnr lnr-cog"></span><span class="menu-text">Demo Gallery</span></a></li>
                            <li><a href="/pages/pricing/"><span class="lnr lnr-cart"></span><span class="menu-text">Pricing</span></a></li>
                            <li><a href="/pages/support-community/"><span class="lnr lnr-bubble"></span><span class="menu-text">Support & Community</span></a></li>
                            <li><a href="/pages/documentation/"><span class="lnr lnr-book"></span><span class="menu-text">Documentation</span></a></li>
                        </ul>
                    </div>
                </div>
            </nav>
            <div class="brand-container">
                <div class="padder clearfix">
                    <div class="brand-more">
                        <a class="brand-more-trigger" href="javascript:void(0);"><span class="lnr lnr-menu"></span> <span class="menu-text">More Tools</span></a>
                        <ul class="brand-more-list hidden">
                            <li><a href="#"><span class="lnr lnr-diamond"></span> ActiveReports</a></li>
                            <li><a href="#"><span class="lnr lnr-poop"></span> ComponentOne</a></li>
                            <li><a href="#"><span class="lnr lnr-bug"></span> Wijmo</a></li>
                            <li><a href="#"><span class="lnr lnr-thumbs-down"></span> Xuni</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </aside><header class="post-header">
    <div class="wrapper">
        <div class="padder clearfix">
            <h1>Spread Windows Forms and Drag and Drop</h1>
        </div>
</header>


<div class="wrapper-sections">
    <section class="post-entry">
        <div class="wrapper">
            <div class="padder clearfix">

                    <p>You can drag and drop data from a Spread control to another Spread control using drag events such as DragEnter, DragOver, and DragDrop. Drag and drop requires fewer steps than copy and paste.</p>
<p>The following example demonstrates using drag and drop with two Spread controls and a list box control.</p>
<ol>
<li>Set the AllowDrop property to true to specify that you can drop data on a control. Set the AllowDragDrop property for Spread as well as the AllowDrop property to allow data to be dropped on the Spread control. For example:</li>
</ol>
<pre><code>fpSpread2.<span class="hljs-variable">AllowDrop =</span> <span class="hljs-constant">true</span>;
fpSpread2.<span class="hljs-variable">AllowDragDrop =</span> <span class="hljs-constant">true</span>;</code></pre>

<p>This Spread example uses data from a database as the source data. For example:</p>
<pre><code>s <span class="hljs-subst">=</span> fpSpread1<span class="hljs-built_in">.</span>ActiveSheet<span class="hljs-built_in">.</span>GetClip(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);

<span class="hljs-built_in">string</span> pathname;
pathname <span class="hljs-subst">=</span> Environment<span class="hljs-built_in">.</span>GetFolderPath(Environment<span class="hljs-built_in">.</span>SpecialFolder<span class="hljs-built_in">.</span>ProgramFiles) <span class="hljs-subst">+</span> <span class="hljs-string">"\\GrapeCity\\Spread Studio 8\\Common\\"</span>;
<span class="hljs-built_in">string</span> conStr <span class="hljs-subst">=</span> <span class="hljs-string">"Provider=Microsoft.JET.OLEDB.4.0;data source= "</span> <span class="hljs-subst">+</span> pathname <span class="hljs-subst">+</span> <span class="hljs-string">"Patients2000.mdb"</span>;
<span class="hljs-built_in">string</span> sqlStr <span class="hljs-subst">=</span> <span class="hljs-string">"SELECT * FROM Patients"</span>;
System<span class="hljs-built_in">.</span><span class="hljs-built_in">Data</span><span class="hljs-built_in">.</span>OleDb<span class="hljs-built_in">.</span>OleDbConnection conn <span class="hljs-subst">=</span> <span class="hljs-literal">new</span> System<span class="hljs-built_in">.</span><span class="hljs-built_in">Data</span><span class="hljs-built_in">.</span>OleDb<span class="hljs-built_in">.</span>OleDbConnection(conStr);
DataSet ds <span class="hljs-subst">=</span> <span class="hljs-literal">new</span> DataSet();
System<span class="hljs-built_in">.</span><span class="hljs-built_in">Data</span><span class="hljs-built_in">.</span>OleDb<span class="hljs-built_in">.</span>OleDbDataAdapter da <span class="hljs-subst">=</span> <span class="hljs-literal">new</span> System<span class="hljs-built_in">.</span><span class="hljs-built_in">Data</span><span class="hljs-built_in">.</span>OleDb<span class="hljs-built_in">.</span>OleDbDataAdapter(sqlStr, conn);
fpSpread1<span class="hljs-built_in">.</span>ActiveSheet<span class="hljs-built_in">.</span>DataAutoSizeColumns <span class="hljs-subst">=</span> <span class="hljs-literal">true</span>;
da<span class="hljs-built_in">.</span>Fill(ds);
fpSpread1<span class="hljs-built_in">.</span>DataSource <span class="hljs-subst">=</span> ds;</code></pre>

<ol>
<li>The DragOver event occurs when the control is being dragged over another object. You can use this event to specify what happens after dragging starts and before the control is dropped. The Spread example uses this event to get the column and row indexes, to clear the previous selection, and to add a new selection based on the selected data.</li>
</ol>
<pre><code>{
            int r, c, rc, cc;
            <span class="hljs-variable">r =</span> cr.Row;
            <span class="hljs-variable">c =</span> cr.Column;
            <span class="hljs-variable">rc =</span> cr.RowCount;
            <span class="hljs-variable">cc =</span> cr.ColumnCount;
            Point <span class="hljs-variable">p =</span> fpSpread2.PointToClient(new Point(e.X, e.Y));
            FarPoint.Win.Spread.Model.CellRange <span class="hljs-variable">range =</span> fpSpread2.GetCellFromPixel(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, p.X, p.Y);
            <span class="hljs-keyword">if</span> (range.<span class="hljs-variable">ColumnCount =</span>= -<span class="hljs-number">1</span> &amp;&amp; range.<span class="hljs-variable">RowCount =</span>= -<span class="hljs-number">1</span>)
                return;
            FarPoint.Win.Spread.Model.CellRange <span class="hljs-variable">sel =</span> fpSpread2.ActiveSheet.GetSelection(<span class="hljs-number">0</span>);
            <span class="hljs-keyword">if</span> (sel != <span class="hljs-constant">null</span>)
            fpSpread2.ActiveSheet.RemoveSelection(sel.Row, sel.Column, sel.RowCount, sel.ColumnCount);

            <span class="hljs-keyword">if</span> (<span class="hljs-variable">cc =</span>= -<span class="hljs-number">1</span>)
            {
                fpSpread2.ActiveSheet.AddSelection(range.Row, -<span class="hljs-number">1</span>, rc, -<span class="hljs-number">1</span>);
            }
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable">rc =</span>= -<span class="hljs-number">1</span>)
            {
                fpSpread2.ActiveSheet.AddSelection(-<span class="hljs-number">1</span>, range.Column, -<span class="hljs-number">1</span>, cc);
            }
            <span class="hljs-keyword">else</span>
            {
                fpSpread2.ActiveSheet.AddSelection(range.Row, range.Column, rc, cc);
            }                       
        }</code></pre>

<ol>
<li>The DragEnter event occurs when the control is dragged into the target drop area. You can use this event to get data and set drag effects. Drag effects in this event will be overwritten if they are also set in the DragOver event. If you want to add effect code to DragOver instead, you could add code similar to the following. This code changes the effect if you also use the Ctrl key. For example:<br>(VB) e.Effect = IIf((ModifierKeys And Keys.Control) = Keys.Control, DragDropEffects.Copy, DragDropEffects.Move) or (C#) e.Effect = ((ModifierKeys &amp; Keys.Control) == Keys.Control ? DragDropEffects.Copy : DragDropEffects.Move);</li>
</ol>
<pre><code>{
            if (e.<span class="hljs-built_in">Data</span>.GetDataPresent(DataFormats.<span class="hljs-built_in">Text</span>))
            {
                e.Effect = DragDropEffects.Move;
            }            
        }</code></pre>

<ol>
<li>The DragDrop event occurs when the mouse is released during the drag and drop operation. Use this event to handle the data you wish to put on the target control. The Spread example uses this event to get the current selection and place the data in the Spread control with the SetClip method.</li>
</ol>
<pre><code>{
            int r, c, rc, cc;
            <span class="hljs-variable">r =</span> cr.Row;
            <span class="hljs-variable">c =</span> cr.Column;
            <span class="hljs-variable">rc =</span> cr.RowCount;
            <span class="hljs-variable">cc =</span> cr.ColumnCount;
            FarPoint.Win.Spread.Model.CellRange <span class="hljs-variable">sel =</span> fpSpread2.ActiveSheet.GetSelection(<span class="hljs-number">0</span>);
            <span class="hljs-keyword">if</span> (sel != <span class="hljs-constant">null</span>)
                fpSpread2.ActiveSheet.SetClip(sel.Row, sel.Column, sel.RowCount, sel.ColumnCount, s);            
        }</code></pre>

<ol>
<li>This example uses the MouseDown event to specify drag drop effects for the right mouse button when getting the data from fpSpread1.</li>
</ol>
<pre><code>{
            <span class="hljs-flow">if</span> (e.Button == MouseButtons.Right)
            {
                fpSpread1.DoDragDrop(s, DragDropEffects.<span class="hljs-keyword">Copy</span> | DragDropEffects.<span class="hljs-built_in">Move</span>);
            }            
        }</code></pre>

<ol>
<li>This example uses the MouseUp event to get data from fpSpread1.</li>
</ol>
<pre><code>{
            <span class="hljs-keyword">try</span>
            {
                cr = fpSpread1.ActiveSheet.GetSelection(<span class="hljs-number">0</span>);
                s = fpSpread1.ActiveSheet.GetClip(cr.Row, cr.Column, cr.RowCount, cr.ColumnCount);
            }
            <span class="hljs-keyword">catch</span> (<span class="hljs-keyword">Exception</span> ex)
            {
                MessageBox.Show(ex.ToString() + <span class="hljs-string">"You did not make a selection!"</span>);
                <span class="hljs-keyword">return</span>;
            }           
        }</code></pre>

<p>You can get the complete sample from: <a href="http://sphelp.grapecity.com/wp-content/uploads/2015/10/DragAndDropCSharp.zip">DragAndDropCSharp</a> or <a href="http://sphelp.grapecity.com/wp-content/uploads/2015/10/DragAndDropVB.zip">DragAndDropVB</a>. You will need to add the Spread references to the project. They are not included in the zip file.</p>
<p>Run the example and select the data from fpSpread1 that you wish to drag, right-click on the selection, then drag it to fpSpread2 or the list box. Release the mouse to drop the data. The mouse pointer must be over a cell in the Spread control (not a header). The list box only displays the data from the active cell in this example.</p>
<p>Drag-drop usually uses the left mouse button. This example uses the right mouse button for drag because the left mouse button is used for the selection in Spread.</p>


            </div>
        </div>
    </section>
</div>
           <footer>
                <div class="wrapper clearfix">
                    <div class="footer-column footer-half">
                        <div class="padder clearfix">
                            <h3>About Spread Studio</h3>
                            <p>Spread Studio is a multi-functional component that combines the utility of a grid with the power and flexibility of a spreadsheet to help developers working in Microsoft® Visual Studio and JavaScript add Microsoft® Excel functionality to their applications or websites. One package delivers a powerful formula engine, input controls, an API, full data import/export for Excel files, advanced charts, print support, and PDF export. Spread Studio is the only component you need in your toolbox for data bound and unbound WinForms, WPF, WinRT, ASP.NET, and JavaScript applications.</p>
                            <p class="copyright-paragraph">
                                ©
                                <span><script>document.write(new Date().getFullYear())</script></span> <img src="/img/company/grapecity_150.png" alt="GrapeCity">, inc. All Rights Reserved. All product and company names herein may be trademarks of their respective owners.
                            </p>

                        </div>
                    </div>
                    <div class="footer-column footer-column-menu">
                        <div class="padder clearfix">
                            <h3>Company</h3>
                            <ul class="footer-menu clearfix">
                                <li><a href="/about-us/">About Us</a></li>
                                <li><a href="/contact-us/">Contact Us</a></li>
                                <li><a href="/legal/">Legal Information</a></li>
                                <li><a href="/privacy/">Privacy Policy</a></li>
                                <li><a href="/terms/">Terms of Use</a></li>
                            </ul>

                        </div>

                    </div>


                </div>
            </footer>
        </article>
    </main>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="/js/app-min.js?v=1"></script>



</body>

</html> 