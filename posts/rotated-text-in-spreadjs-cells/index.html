<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Rotated Text in SpreadJS Cells</title>
    <meta name="description" content="Spread Studio is our new cross-platform toolkit that includes components for Windows Forms, ASP.NET, WPF, WinRT, and Silverlight all in one package. This new package includes the new releases of Spread for WinForms and Spread for ASP.NET." name="description" />
    <meta name="keywords" content="Spread.NET, ASP.NET, WPF, Silverlight, WinRT, .NET, spreadsheets, Data, PDF, Spreadsheet, Grid, Excel, analysis, GrapeCity, ASP.NET Spreadsheet component, .NET Spreadsheet component">

    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/favicon-194x194.png" sizes="194x194">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <meta name="DC.title" content="GrapeCity Spread" />
    <meta name="geo.region" content="US-NC" />
    <meta name="geo.placename" content="Raleigh" />
    <meta name="geo.position" content="40.458677;-79.924935" />
    <meta name="ICBM" content="40.458677, -79.924935" />

    <!-- Schema.org markup for Google+ -->
    <meta itemprop="name" content="GrapeCity Spread">
    <meta itemprop="description" content="Spreadsheet Components for .NET and JavaScript-HTML5">
    <meta itemprop="image" content="http://spread.grapecity.com/img/spread-photo.png">
    <link href="https://plus.google.com/103999002053720301182/" rel="publisher" />

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="GrapeCity Spread">
    <meta name="twitter:site" content="@gcspread">
    <meta name="twitter:title" content="Spreadsheet Components for .NET and JavaScript-HTML5">
    <meta name="twitter:description" content="Spreadsheet Components for .NET and JavaScript-HTML5">
    <meta name="twitter:creator" content="@gcspread">
    <meta name="twitter:image" content="http://spread.grapecity.com/img/spread-photo.png">

    <!-- Open Graph data -->
    <meta property="og:title" content="GrapeCity Spread" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="http://spread.grapecity.com/" />
    <meta property="og:image" content="http://spread.grapecity.com/img/spread-photo.png" />
    <meta property="og:description" content="Spreadsheet Components for .NET and JavaScript-HTML5" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/css/style.css?v=1" />

</head>

<body class=" page-Rotated Text in SpreadJS Cells">
    <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->




    <main class="body-section">
        <article class="body-inner">    <div class="nav-bar">
        <div class="nav-bar-inner">
            <div class="wrapper">
                <div class="padder clearfix">
                    <div class="search-container clearfix">
                        <input placeholder="Search" type="search" />
                        <a class="search-trigger" href="#"><span class="lnr lnr-magnifier"></span></a>
                    </div>
                    <div class="user-container">
                        <a class="user-trigger" href="#"><span class="lnr lnr-user"></span> <span class="menu-text">Account</span></a>
                        <ul class="user-list hidden">
                            <li><a href="#"><span class="lnr lnr-exit-up"></span> Sign Out</a></li>
                            <li><a href="#"><span class="lnr lnr-license"></span> Licenses</a></li>
                            <li><a href="#"><span class="lnr lnr-bug"></span> Submit An Issue</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>


<aside class="brand-section">
        <div class="brand-inner clearfix">
            <div class="brand-main">
                <div class="brand-logo">
                    <div class="padder clearfix">
                        <h2><a href="/"><img src="/img/sp-icon-white.svg" alt="Spread" /><span class="logo-text">Spread</span> </a></h2>
                    </div>
                </div>
            </div>
            <nav class="nav-main">
                <div class="nav-section">
                    <div class="padder clearfix">
                        <ul class="clearfix">
                            <li class="studio">
                                <a href="/products/spread-studio/"><img src="/img/sp-icon.svg" /><span class="menu-text">Spread Studio</span></a>
                            </li>
                            <li class="js">
                                <a href="/products/spreadjs/"><img src="/img/js-icon.svg" /><span class="menu-text">SpreadJS</span></a>
                            </li>
                            <li class="com">
                                <a href="/products/spread-com/"><img src="/img/com-icon.svg" /><span class="menu-text">Spread COM</span></a>
                            </li>
                            <li><a href="/pages/downloads/"><span class="lnr lnr-download"></span><span class="menu-text">Downloads</span></a></li>
                            <li><a href="/pages/demo-gallery/"><span class="lnr lnr-cog"></span><span class="menu-text">Demo Gallery</span></a></li>
                            <li><a href="/pages/pricing/"><span class="lnr lnr-cart"></span><span class="menu-text">Pricing</span></a></li>
                            <li><a href="/pages/support-community/"><span class="lnr lnr-bubble"></span><span class="menu-text">Support & Community</span></a></li>
                            <li><a href="/pages/documentation/"><span class="lnr lnr-book"></span><span class="menu-text">Documentation</span></a></li>
                        </ul>
                    </div>
                </div>
            </nav>
            <div class="brand-container">
                <div class="padder clearfix">
                    <div class="brand-more">
                        <a class="brand-more-trigger" href="javascript:void(0);"><span class="lnr lnr-menu"></span> <span class="menu-text">More Tools</span></a>
                        <ul class="brand-more-list hidden">
                            <li><a href="#"><span class="lnr lnr-diamond"></span> ActiveReports</a></li>
                            <li><a href="#"><span class="lnr lnr-poop"></span> ComponentOne</a></li>
                            <li><a href="#"><span class="lnr lnr-bug"></span> Wijmo</a></li>
                            <li><a href="#"><span class="lnr lnr-thumbs-down"></span> Xuni</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </aside><header>
    <div class="wrapper">
        <div class="padder clearfix">
            <h1><span class="lnr lnr-book"></span> Rotated Text in SpreadJS Cells</h1>
            <h3></h3>
        </div>
</header>


<div class="wrapper-sections">
    <section class="section-page">
        <div class="wrapper">
            <div class="padder clearfix">
                <div class="entry">

                    <p>A frequently-asked question is how to rotate cell contents to vertical (or some other angle) in a SpreadSheet. The short answer is that you can&#8217;t. However, <a href="http://sphelp.grapecity.com/webhelp/SpreadJSWeb/webframe.html#getstarted.html" target="_blank">SpreadJS</a> provides simple workaround using CustomCellType in which we can rotate the text.</p>
<p>Sometimes there&#8217;s just too much text to display in SpreadSheet cells. Although you can try wrapping text, using acronyms or shortening words, widen your columns too much to enable viewing of all columns on a single screen. However, scrolling back and forth takes time. So, its better to spend time in designing the business spreadsheet.</p>
<p>You can rotate text clockwise, counterclockwise, or vertically by creating <a href="http://sphelp.grapecity.com/webhelp/SpreadJSWeb/webframe.html#cellcustom.html" target="_blank">CustomCellType</a>.</p>
<p>Here in this blog lets discuss how we can create CustomCellType to display text vertically in SpreadSheet cells. This is how SpreadJS will show text in Spreadsheet cells.</p>
<p><a href="http://sphelp.grapecity.com/wp-content/uploads/2015/06/RotateText.jpg"><img src="http://sphelp.grapecity.com/wp-content/uploads/2015/06/RotateText.jpg" alt="" width="505" height="459" class="alignnone size-full wp-image-663380" /></a></p>
<p>For the demonstration purpose, lets name this CustomCellType as RotateTextCellType which will display text vertically in SpreadSheet Cells. Here, we need to override the paint event of RotateTextCellType.</p>
<pre>[csharp]var ns = $.wijmo.wijspread;
    function RotateTextCellType() { }
    RotateTextCellType.prototype = new ns.TextCellType();
    RotateTextCellType.prototype.paint = function (ctx, value, x, y, w, h, style, context) {
        ctx.save();
        ctx.rect(x, y, w, h);
        ctx.clip();
        var tw = this.getAutoFitWidth(value, value.toString(), style, 1, context);
        var th = this.getAutoFitHeight(value, value.toString(), style, 1, context);
        if (style.hAlign === ns.HorizontalAlign.general) {
            style.hAlign = ns.HorizontalAlign.left;
            var type = $.type(value);
            if (type === "boolean") {
                style.hAlign = ns.HorizontalAlign.center;
            } else if (type === "number" || type === "date") {
                style.hAlign = ns.HorizontalAlign.right;
            }
        }
        if (style.hAlign === ns.HorizontalAlign.center) {
            x += (w + tw) / 2;
        } else if (style.hAlign === ns.HorizontalAlign.right) {
            x += w - tw / 2;
        } else {
            x += tw;
        }
        if (style.vAlign === ns.VerticalAlign.center) {
            y += (h - th) / 2;
        } else if (style.vAlign === ns.VerticalAlign.bottom) {
            y += h - th - 2;
        } else {
            y += 2;
        }
        ctx.beginPath();
        ctx.translate(x, y);
        ctx.rotate(-0.5 * Math.PI);
        ctx.fillText(value, 0, 0);
        ctx.restore();
    };
    RotateTextCellType.prototype.getAutoFitHeight = function (value, text, cellStyle, zoomFactor, context) {
        return ns.TextCellType.prototype.getAutoFitWidth.apply(this, arguments);
    };
    RotateTextCellType.prototype.getAutoFitWidth = function (value, text, cellStyle, zoomFactor, context) {
        return ns.TextCellType.prototype.getAutoFitHeight.apply(this, arguments);
    }
    $(document).ready(function () {
        var spread = new GcSpread.Sheets.Spread($("#ss").get(0), { sheetCount: 1 });
        var sheet = spread.getActiveSheet();
        sheet.setColumnCount(5);
        sheet.setRowCount(5);
        sheet.isPaintSuspended(true);
        sheet.getCell(1, 1).value("Left-Top").cellType(new RotateTextCellType()).hAlign(ns.HorizontalAlign.left).vAlign(ns.VerticalAlign.top);
        sheet.getCell(2, 1).value("Left-Center").cellType(new RotateTextCellType()).hAlign(ns.HorizontalAlign.left).vAlign(ns.VerticalAlign.center);
        sheet.getCell(3, 1).value("Left-Bottom").cellType(new RotateTextCellType()).hAlign(ns.HorizontalAlign.left).vAlign(ns.VerticalAlign.bottom);
        sheet.getCell(1, 2).value("Center-Top").cellType(new RotateTextCellType()).hAlign(ns.HorizontalAlign.center).vAlign(ns.VerticalAlign.top);
        sheet.getCell(2, 2).value("Center-Center").cellType(new RotateTextCellType()).hAlign(ns.HorizontalAlign.center).vAlign(ns.VerticalAlign.center);
        sheet.getCell(3, 2).value("Center-Bottom").cellType(new RotateTextCellType()).hAlign(ns.HorizontalAlign.center).vAlign(ns.VerticalAlign.bottom);
        sheet.getCell(1, 3).value("Right-Top").cellType(new RotateTextCellType()).hAlign(ns.HorizontalAlign.right).vAlign(ns.VerticalAlign.top);
        sheet.getCell(2, 3).value("Right-Center").cellType(new RotateTextCellType()).hAlign(ns.HorizontalAlign.right).vAlign(ns.VerticalAlign.center);
        sheet.getCell(3, 3).value("Right-Bottom").cellType(new RotateTextCellType()).hAlign(ns.HorizontalAlign.right).vAlign(ns.VerticalAlign.bottom);
        sheet.autoFitRow(1);
        sheet.autoFitRow(2);
        sheet.autoFitRow(3);
        sheet.isPaintSuspended(false);
    });
[/csharp]</pre>

<p>This concludes my blog. You can <a href="http://sphelp.grapecity.com/wp-content/uploads/2015/06/RotateText_JS.html">Download Sample</a> for detailed implementation.</p>


                </div>
            </div>
        </div>
    </section>
</div>
           <footer>
                <div class="wrapper clearfix">
                    <div class="footer-column footer-half">
                        <div class="padder clearfix">
                            <h3>About Spread Studio</h3>
                            <p>Spread Studio is a multi-functional component that combines the utility of a grid with the power and flexibility of a spreadsheet to help developers working in Microsoft® Visual Studio and JavaScript add Microsoft® Excel functionality to their applications or websites. One package delivers a powerful formula engine, input controls, an API, full data import/export for Excel files, advanced charts, print support, and PDF export. Spread Studio is the only component you need in your toolbox for data bound and unbound WinForms, WPF, WinRT, ASP.NET, and JavaScript applications.</p>
                            <p class="copyright-paragraph">
                                ©
                                <span><script>document.write(new Date().getFullYear())</script></span> <img src="/img/company/grapecity_150.png" alt="GrapeCity">, inc. All Rights Reserved. All product and company names herein may be trademarks of their respective owners.
                            </p>

                        </div>
                    </div>
                    <div class="footer-column footer-column-menu">
                        <div class="padder clearfix">
                            <h3>Company</h3>
                            <ul class="footer-menu clearfix">
                                <li><a href="/about-us/">About Us</a></li>
                                <li><a href="/contact-us/">Contact Us</a></li>
                                <li><a href="/legal/">Legal Information</a></li>
                                <li><a href="/privacy/">Privacy Policy</a></li>
                                <li><a href="/terms/">Terms of Use</a></li>
                            </ul>

                        </div>

                    </div>


                </div>
            </footer>
        </article>
    </main>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="/js/dist/jquery.unslider-dist.js"></script>
    <script src="/js/dist/jquery.matchHeight-dist.js"></script>
    <script src="/js/dist/jquery.waypoints-dist.js"></script>
    <script src="/js/dist/jquery.nicescroll-dist.js"></script>
    <script src="/js/dist/jquery.velocity-dist.js"></script>
    <script src="/js/dist/jquery.event.move-dist.js"></script>
    <script src="/js/dist/jquery.event.swipe-dist.js"></script>
    <script src="/js/dist/init-dist.js"></script>



</body>

</html> 